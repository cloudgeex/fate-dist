{"version":3,"file":"fate-editor.js","sources":["ng://fate-editor/app/fate-type.enum.ts","ng://fate-editor/app/fate-link-dropdown/fate-link-dropdown.component.ts","ng://fate-editor/app/fate-controller.service.ts","ng://fate-editor/app/fate-node.ts","ng://fate-editor/app/fate-html-parser.service.ts","ng://fate-editor/app/fate-parser.service.ts","ng://fate-editor/app/fate-icon.service.ts","ng://fate-editor/app/fate-ui/fate-ui.component.ts","ng://fate-editor/app/fate-input/fate-input.component.ts","ng://fate-editor/app/fate-bootstrap/fate-bootstrap.component.ts","ng://fate-editor/app/fate-material-icon.service.ts","ng://fate-editor/app/fate-material/fate-material.component.ts","ng://fate-editor/app/fate-fontawsome-legacy-icon.service.ts","ng://fate-editor/app/fate.module.ts","ng://fate-editor/fate-editor.ts"],"sourcesContent":["export enum FateType {\n  NONE = 'NONE',\n  PARAGRAPH = 'PARAGRAPH',\n  HEADER1 = 'HEADER1',\n  HEADER2 = 'HEADER2',\n  HEADER3 = 'HEADER3',\n  HEADER4 = 'HEADER4',\n  HEADER5 = 'HEADER5',\n  HEADER6 = 'HEADER6',\n  QUOTE = 'QUOTE',\n  CODE = 'CODE',\n  SIZE = 'SIZE',\n  BOLD = 'BOLD',\n  HIGHLIGHT = 'HIGHLIGHT',\n  SUBSCRIPT = 'SUBSCRIPT',\n  SUPERSCRIPT = 'SUPERSCRIPT',\n  STRIKETHROUGH = 'STRIKETHROUGH',\n  ITALIC = 'ITALIC',\n  COLOR = 'COLOR',\n  UNDERLINE = 'UNDERLINE',\n  LINK = 'LINK',\n  ALIGN_LEFT = 'ALIGN_LEFT',\n  ALIGN_CENTER = 'ALIGN_CENTER',\n  ALIGN_RIGHT = 'ALIGN_RIGHT',\n  JUSTIFY = 'JUSTIFY',\n  ORDERED_LIST = 'ORDERED_LIST',\n  UNORDERED_LIST = 'UNORDERED_LIST',\n  LISTITEM = 'LISTITEM',\n  INDENT = 'INDENT',\n  TYPEFACE = 'TYPEFACE',\n}\n","import { Component, Input, Output, EventEmitter } from '@angular/core';\n\nimport { FateDropdown } from '../fate-dropdown.interface';\n\n@Component({\n  selector: 'fate-link-dropdown',\n  templateUrl: './fate-link-dropdown.component.html',\n  styleUrls: ['./fate-link-dropdown.component.scss']\n})\nexport class FateLinkDropdownComponent implements FateDropdown {\n\n  @Input()\n  public value: string;\n\n  @Output()\n  public valueChange = new EventEmitter<string>();\n\n  public changeValue (value) {\n    this.value = value;\n    this.valueChange.emit(value);\n  }\n\n  public selectNext () {};\n  public selecPrevious () {};\n  public confirmSelection () {};\n}\n","import { Injectable } from '@angular/core';\n\nimport { Subject } from 'rxjs';\n\nimport { FateType } from './fate-type.enum';\nimport { FateLinkDropdownComponent } from './fate-link-dropdown/fate-link-dropdown.component';\n\nexport interface FateCommand {\n  name: string;\n  value: any;\n}\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class FateControllerService {\n  // List of available commands, alphabetically\n  // see https://developer.mozilla.org/en-US/docs/Web/API/Document/execCommand\n  protected actionMapping = {\n    bold: {\n      command: 'bold',\n      name: 'Bold',\n      detect: FateType.BOLD\n    },\n    italic: {\n      command: 'italic',\n      name: 'Italic',\n      detect: FateType.ITALIC\n    },\n    underline: {\n      command: 'underline',\n      name: 'Underlined',\n      detect: FateType.UNDERLINE\n    },\n    strike: {\n      command: 'strikeThrough',\n      name: 'Strike Through',\n      detect: FateType.STRIKETHROUGH\n    },\n    subscript: {\n      command: 'subscript',\n      name: 'Subscript',\n      label: 'sub',\n      detect: FateType.SUBSCRIPT\n    },\n    superscript: {\n      command: 'superscript',\n      name: 'Superscript',\n      label: 'sup',\n      detect: FateType.SUPERSCRIPT\n    },\n    heading1: {\n      command: 'formatBlock',\n      value: 'H1',\n      name: '1st Header',\n      label: 'h1',\n      detect: FateType.HEADER1\n    },\n    heading2: {\n      command: 'formatBlock',\n      value: 'H2',\n      name: '2nd Header',\n      label: 'h2',\n      detect: FateType.HEADER2\n    },\n    heading3: {\n      command: 'formatBlock',\n      value: 'H3',\n      name: '3rd Header',\n      label: 'h3',\n      detect: FateType.HEADER3\n    },\n    heading4: {\n      command: 'formatBlock',\n      value: 'H4',\n      name: '4th Header',\n      label: 'h4',\n      detect: FateType.HEADER4\n    },\n    heading5: {\n      command: 'formatBlock',\n      value: 'H5',\n      name: '5th Header',\n      label: 'h5',\n      detect: FateType.HEADER5\n    },\n    heading6: {\n      command: 'formatBlock',\n      value: 'H6',\n      name: '6th Header',\n      label: 'h6',\n      detect: FateType.HEADER6\n    },\n    normal: {\n      command: 'formatBlock',\n      value: 'DIV',\n      name: 'Normal',\n      label: 'p'\n    },\n    indent: {\n      command: 'indent',\n      name: 'Indent'\n    },\n    outdent: {\n      command: 'outdent',\n      name: 'Outdent'\n    },\n    ordered: {\n      command: 'insertOrderedList',\n      name: 'Ordered List',\n      detect: FateType.ORDERED_LIST\n    },\n    unordered: {\n      command: 'insertUnorderedList',\n      name: 'Unorder List',\n      detect: FateType.UNORDERED_LIST\n    },\n    center: {\n      command: 'justifyCenter',\n      name: 'Center',\n      detect: FateType.ALIGN_CENTER\n    },\n    justify: {\n      command: 'justifyFull',\n      name: 'Justify',\n      detect: FateType.JUSTIFY\n    },\n    left: {\n      command: 'justifyLeft',\n      name: 'Left',\n      detect: FateType.ALIGN_LEFT\n    },\n    right: {\n      command: 'justifyRight',\n      name: 'Right',\n      detect: FateType.ALIGN_RIGHT\n    },\n    undo: {\n      command: 'undo',\n      name: 'Undo'\n    },\n    redo: {\n      command: 'redo',\n      name: 'Redo'\n    },\n    clean: {\n      command: 'removeFormat',\n      name: 'Remove Formating'\n    },\n    link: {\n      command: 'createLink',\n      undo: 'unlink',\n      name: 'Link',\n      detect: FateType.LINK,\n      dropdown: FateLinkDropdownComponent\n    }\n  };\n  public registerAction(name: string, action: any) {\n    if (this.actionMapping[name]) {\n      throw new Error('An action with the name \"' + name + '\" already exists!');\n    } else {\n      this.actionMapping[name] = action;\n    }\n  }\n  public getAction(actionName): boolean | any {\n    return this.actionMapping[actionName] || false;\n  }\n\n  protected inlineActionMapping: any = {};\n  public registerInlineAction(name: string, action: any) {\n    if (this.inlineActionMapping[name]) {\n      throw new Error(\n        'An inline action with the name \"' + name + '\" already exists!'\n      );\n    } else {\n      this.inlineActionMapping[name] = action;\n    }\n  }\n  public getInlineAction(context: string): boolean | any {\n    for (const action of Object.keys(this.inlineActionMapping)) {\n      const match = this.inlineActionMapping[action].regexp.exec(context);\n      if (match) {\n        this.inlineActionMapping[action].matched = match[1];\n        return this.inlineActionMapping[action];\n      }\n    }\n    return false;\n  }\n\n  protected commandsPipe = {\n    default: new Subject<FateCommand>()\n  };\n\n  protected enabledActions = {\n    default: new Subject<any>()\n  };\n\n  constructor() {}\n\n  public channel(channelId) {\n    if (!this.commandsPipe[channelId]) {\n      this.commandsPipe[channelId] = new Subject<FateCommand>();\n    }\n    return this.commandsPipe[channelId];\n  }\n\n  public enabled(channelId) {\n    if (!this.enabledActions[channelId]) {\n      this.enabledActions[channelId] = new Subject<any>();\n    }\n    return this.enabledActions[channelId];\n  }\n\n  public enableActions(channelId, nodes) {\n    const actions: Array<any> = [];\n    for (const node of nodes) {\n      for (const action in this.actionMapping) {\n        if (\n          this.actionMapping[action].detect &&\n          this.actionMapping[action].detect === node.type\n        ) {\n          actions.push({ action: action, value: node.value });\n        } else if (\n          this.actionMapping[action].detect &&\n          typeof this.actionMapping[action].detect === 'function'\n        ) {\n          const detected = this.actionMapping[action].detect(node);\n          if (detected) {\n            actions.push({ action: action, value: detected.value });\n          }\n        }\n      }\n    }\n    this.enabledActions[channelId].next(actions);\n  }\n\n  public do(channel, action, value?) {\n    if (this.actionMapping[action].dropdown && !value) {\n      if (this.actionMapping[action].undo) {\n        this.commandsPipe[channel].next({\n          name: this.actionMapping[action].undo,\n          value: this.actionMapping[action].value || value\n        });\n      } else {\n        throw new Error('Action \"' + action + '\"doesn\\'t have a undo command');\n      }\n    } else {\n      if (\n        this.actionMapping[action].value &&\n        typeof this.actionMapping[action].value === 'function'\n      ) {\n        this.commandsPipe[channel].next({\n          name: this.actionMapping[action].command,\n          value: this.actionMapping[action].value(value)\n        });\n      } else {\n        this.commandsPipe[channel].next({\n          name: this.actionMapping[action].command,\n          value: this.actionMapping[action].value || value\n        });\n      }\n    }\n  }\n\n  public doInline(channel, action, value?) {\n    if (action.dropdown && !value) {\n      if (action.undo) {\n        this.commandsPipe[channel].next({\n          name: action.undo,\n          value: action.value || value\n        });\n      } else {\n        throw new Error('Action \"' + action + '\"doesn\\'t have a undo command');\n      }\n    } else {\n      if (action.value && typeof action.value === 'function') {\n        this.commandsPipe[channel].next({\n          name: action.command,\n          value: action.value(value)\n        });\n      } else {\n        this.commandsPipe[channel].next({\n          name: action.command,\n          value: action.value || value\n        });\n      }\n    }\n  }\n\n  public undo(channel, action, value?) {\n    const mapping = this.actionMapping[action].undo;\n    // TODO\n  }\n}\n","import { FateType } from './fate-type.enum';\n\nexport class FateNode {\n  constructor(public type: FateType = FateType.NONE, public value?: any) {}\n\n  public children: Array<FateNode | string> = [];\n}\n","import { Injectable } from '@angular/core';\n\nimport { FateNode } from './fate-node';\nimport { FateType } from './fate-type.enum';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class FateHtmlParserService {\n\n  constructor() { }\n\n  public parse(html: string): FateNode {\n    const div = document.createElement('div');\n    div.innerHTML = html;\n    return this.parseElement(div);\n  };\n\n  public parseElement(element: HTMLElement): FateNode {\n    const nodes = this.parseType(element);\n    let currentNode = nodes[0];\n    \n    let isABlock = (currentNode.type === FateType.PARAGRAPH);\n    for (let i = 1; i < nodes.length; i++) {\n      currentNode.children.push(nodes[i]);\n      currentNode = nodes[i];\n      if (currentNode.type === FateType.PARAGRAPH) {\n        isABlock = true;\n      }\n    }\n\n    let previousNodeWasText = false;\n    for (let i = 0; i < element.childNodes.length; i ++) {\n      const child = element.childNodes[i];\n      // pick ahead to look for <br>\n      if (\n          (i < element.childNodes.length - 1) &&\n          (this.isLinebreak(element.childNodes[i + 1])) &&\n          !(isABlock && i === element.childNodes.length - 2) // The last child is a BR in a block, this can be ignored\n        ) {\n\n        previousNodeWasText = false;\n        if (child instanceof Text) {\n          // wrap the text in a paragraph\n          const paragraph = new FateNode(FateType.PARAGRAPH);\n          paragraph.children.push(child.data);\n          currentNode.children.push(paragraph);\n        } else if (child instanceof HTMLElement) {\n          // insert an empty paragraph\n          currentNode.children.push(this.parseElement(child));\n          currentNode.children.push(new FateNode(FateType.PARAGRAPH));\n        } else {\n          // ignore\n        }\n      } else {\n        if (child instanceof Text) {\n          // If two \"pure\" text node follow one another we can safely merge then as one (for i > 0)\n          if (previousNodeWasText) {\n            currentNode.children[currentNode.children.length - 1] = currentNode.children[currentNode.children.length - 1] + child.data;\n          } else {\n            currentNode.children.push(child.data);\n          }\n          previousNodeWasText = true;\n        } else if (child instanceof HTMLElement) {\n          currentNode.children.push(this.parseElement(child));\n          previousNodeWasText = false;\n        } else {\n          // ignore\n        }\n      }\n    }\n    return nodes[0];\n  }\n\n  public findParentNodes(node: Node, until: Node): Array<FateNode> {\n    const nodes: Array<FateNode> = [];\n    let current: HTMLElement = (node.nodeType === 1) ? (node as HTMLElement) : node.parentElement;\n    while (current !== until) {\n      nodes.push(...this.parseType(current));\n      current = current.parentElement;\n    }\n    return nodes;\n  }\n\n  protected getAdditonalStyle(element: HTMLElement): Array<FateNode> {\n    const style = element.style;\n    const detectedStyleNode = [];\n    // Look for alignement\n    const align = element.getAttribute('align') || style.textAlign;\n    switch (align) {\n      case 'left':\n        detectedStyleNode.push(new FateNode(FateType.ALIGN_LEFT));\n        break;\n      case 'center':\n        detectedStyleNode.push(new FateNode(FateType.ALIGN_CENTER));\n        break;\n      case 'right':\n        detectedStyleNode.push(new FateNode(FateType.ALIGN_RIGHT));\n        break;\n      case 'justify':\n        detectedStyleNode.push(new FateNode(FateType.JUSTIFY));\n        break;\n    }\n    // Look for color\n    const color = element.getAttribute('color') || style.color;\n    if(color) {\n      detectedStyleNode.push(new FateNode(FateType.COLOR, color));\n    }\n    // Look for size\n    const size = element.getAttribute('size') || style.fontSize;\n    if (size) {\n      detectedStyleNode.push(new FateNode(FateType.SIZE, size));\n    }\n    // Look for family\n    const typeface = element.getAttribute('face') || style.fontFamily;\n    if (typeface) {\n      detectedStyleNode.push(new FateNode(FateType.TYPEFACE, typeface));\n    }\n\n    return detectedStyleNode;\n  }\n\n  protected parseType(element: HTMLElement): Array<FateNode> {\n    const additionaStyle = this.getAdditonalStyle(element);\n    switch (element.nodeName) {\n      case 'H1':\n        return [new FateNode(FateType.HEADER1), ...additionaStyle];\n      case 'H2':\n        return [new FateNode(FateType.HEADER2), ...additionaStyle];\n      case 'H3':\n        return [new FateNode(FateType.HEADER3), ...additionaStyle];\n      case 'H4':\n        return [new FateNode(FateType.HEADER4), ...additionaStyle];\n      case 'H5':\n        return [new FateNode(FateType.HEADER5), ...additionaStyle];\n      case 'H6':\n        return [new FateNode(FateType.HEADER6), ...additionaStyle];\n      case 'B':\n      case 'STRONG':\n        return [new FateNode(FateType.BOLD)];\n      case 'I':\n      case 'EM':\n        return [new FateNode(FateType.ITALIC)];\n      case 'U':\n        return [new FateNode(FateType.UNDERLINE)];\n      case 'STRIKE':\n        return [new FateNode(FateType.STRIKETHROUGH)];\n      case 'SUB':\n        return [new FateNode(FateType.SUBSCRIPT)];\n      case 'SUP':\n        return [new FateNode(FateType.SUPERSCRIPT)];\n      case 'A':\n        return [new FateNode(FateType.LINK, element.getAttribute('href'))];\n      case 'OL':\n        return [new FateNode(FateType.ORDERED_LIST)];\n      case 'UL':\n        return [new FateNode(FateType.UNORDERED_LIST)];\n      case 'LI':\n        return [new FateNode(FateType.LISTITEM)];\n      case 'DIV':\n      case 'P':\n        if (additionaStyle.length > 0) {\n          return [...additionaStyle];\n        }\n        return [new FateNode(FateType.PARAGRAPH)];\n      case 'BLOCKQUOTE':\n        // FIXME: this doesn't work on FF\n        if (element.style.marginLeft === '40px') {\n          return [new FateNode(FateType.INDENT)];\n        }\n        return [new FateNode(FateType.NONE)];\n      default:\n        if (additionaStyle.length > 0) {\n          return [...additionaStyle];\n        }\n        return [new FateNode(FateType.NONE)];\n    }\n  }\n\n  protected parseValue(element: HTMLElement): any {\n    switch (element.nodeName) {\n      case 'A':\n        return element.getAttribute('href');\n    }\n    return undefined;\n  }\n\n  protected serializeType(node: FateNode): string {\n    switch (node.type) {\n      case FateType.PARAGRAPH:\n        return '<div>' + this.serialize(node, true) + '</div>';\n      case FateType.HEADER1:\n        return '<h1>' + this.serialize(node, true) + '</h1>';\n      case FateType.HEADER2:\n        return '<h2>' + this.serialize(node, true) + '</h2>';\n      case FateType.HEADER3:\n        return '<h3>' + this.serialize(node, true) + '</h3>';\n      case FateType.HEADER4:\n        return '<h4>' + this.serialize(node, true) + '</h4>';\n      case FateType.HEADER5:\n        return '<h5>' + this.serialize(node, true) + '</h5>';\n      case FateType.HEADER6:\n        return '<h6>' + this.serialize(node, true) + '</h6>';\n      case FateType.QUOTE:\n        return '<quote>' + this.serialize(node) + '</quote>';\n      case FateType.CODE:\n        return '<code>' + this.serialize(node) + '</code>';\n      case FateType.BOLD:\n        return '<strong>' + this.serialize(node) + '</strong>';\n      case FateType.ITALIC:\n        return '<em>' + this.serialize(node) + '</em>';\n      case FateType.UNDERLINE:\n        return '<u>' + this.serialize(node) + '</u>';\n      case FateType.STRIKETHROUGH:\n        return '<strike>' + this.serialize(node) + '</strike>';\n      case FateType.SUBSCRIPT:\n        return '<sub>' + this.serialize(node) + '</sub>';\n      case FateType.SUPERSCRIPT:\n        return '<sup>' + this.serialize(node) + '</sup>';\n      case FateType.LINK:\n        return '<a href=\"' + node.value + '\">' + this.serialize(node) + '</a>';\n      case FateType.ORDERED_LIST:\n        return '<ol>' + this.serialize(node) + '</ol>';\n      case FateType.UNORDERED_LIST:\n        return '<ul>' + this.serialize(node) + '</ul>';\n      case FateType.LISTITEM:\n        return '<li>' + this.serialize(node) + '</li>';\n      case FateType.ALIGN_LEFT:\n        return '<div style=\"text-align: left;\">' + this.serialize(node, true) + '</div>';\n      case FateType.ALIGN_CENTER:\n        return '<div style=\"text-align: center;\">' + this.serialize(node, true) + '</div>';\n      case FateType.ALIGN_RIGHT:\n        return '<div style=\"text-align: right\">' + this.serialize(node, true) + '</div>';\n      case FateType.JUSTIFY:\n        return '<div style=\"text-align: justify;\">' + this.serialize(node, true) + '</div>';\n      case FateType.INDENT:\n        return '<blockquote style=\"margin-left: 40px\">' + this.serialize(node, true) + '</blockquote>';\n      case FateType.COLOR:\n        return '<font color=\"' + node.value + '\">' + this.serialize(node) + '</font>';\n      case FateType.SIZE:\n        return '<font size=\"' + node.value + '\">' + this.serialize(node) + '</font>';\n      case FateType.TYPEFACE:\n        return '<font face=\"' + node.value + '\">' + this.serialize(node) + '</font>';\n      case FateType.NONE:\n        return this.serialize(node);\n    }\n  };\n\n  protected isLinebreak(child: Node): boolean {\n    return (child instanceof HTMLElement && child.nodeName === 'BR');\n  }\n\n  // Saves a Tree in string representation\n  public serialize (node: FateNode, fallbackToBr: boolean = false): string {\n    let serialized = '';\n    node.children.forEach((child) => {\n      if (typeof child === 'string') {\n        serialized += child;\n      } else {\n        serialized += this.serializeType(child);\n      }\n    });\n    if (fallbackToBr && !serialized) {\n      serialized = '<br>';\n    }\n    return serialized;\n  };\n}\n","import { Injectable } from '@angular/core';\n\nimport { FateHtmlParserService } from './fate-html-parser.service';\nimport { FateParser } from './fate-parser.interface';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class FateParserService extends FateHtmlParserService implements FateParser {}\n","import { Injectable } from '@angular/core';\n\nimport { FateIcon } from './fate-icon.interface';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class FateIconService implements FateIcon {\n  // font awesome\n  protected iconMapping: any = {\n    bold: 'bold',\n    italic: 'italic',\n    underline: 'underline',\n    strike: 'strikethrough',\n    subscript: 'subscript',\n    superscript: 'superscript',\n    indent: 'indent',\n    outdent: 'outdent',\n    ordered: 'list-ol',\n    unordered: 'list-ul',\n    center: 'align-center',\n    justify: 'align-justify',\n    left: 'align-left',\n    right: 'align-right',\n    undo: 'undo-alt',\n    redo: 'redo-alt',\n    clean: 'eraser',\n    link: 'link'\n  };\n\n  public getIcon(actionName): string {\n    return this.iconMapping[actionName];\n  }\n}\n","import { Component, Input, ElementRef, HostListener, OnChanges, AfterViewInit, ComponentFactoryResolver, ViewChild, ViewContainerRef, ViewRef } from '@angular/core';\n\nimport { Subscription } from 'rxjs';\n\nimport { FateControllerService } from '../fate-controller.service';\nimport { FateParserService } from '../fate-parser.service';\nimport { FateIconService } from '../fate-icon.service';\n\nexport const defaultButtons = [\n  'bold',\n  'italic',\n  'underline',\n  'strike',\n  'separator',\n  'subscript',\n  'superscript',\n  'link',\n  'separator',\n  'heading1',\n  'heading2',\n  'heading3',\n  'heading4',\n  'heading5',\n  'heading6',\n  'normal',\n  'separator',\n  'indent',\n  'outdent',\n  'ordered',\n  'unordered',\n  'separator',\n  'center',\n  'justify',\n  'left',\n  'right',\n  'separator',\n  'undo',\n  'redo',\n  'clean'\n];\n\n@Component({\n  selector: 'fate-ui',\n  templateUrl: './fate-ui.component.html',\n  styleUrls: ['./fate-ui.component.scss']\n})\nexport class FateUiComponent implements OnChanges, AfterViewInit {\n\n  @Input()\n  public uiId: string = 'default';\n\n  @Input()\n  public buttons: Array<string> = defaultButtons;\n\n  public enabled: any = {};\n  public dropdownAction: boolean | string = false;\n  public dropdownValue: string;\n  protected dropdownComponent: ViewRef;\n\n  protected inputSubscription: Subscription;\n\n  constructor(protected el: ElementRef, public controller: FateControllerService, public icon: FateIconService, protected parser: FateParserService, protected factoryResolver: ComponentFactoryResolver) { }\n\n  @HostListener('mousedown', ['$event'])\n  public mouseDown(event) {\n    if (!event.target.closest('.fate-ui-dropdown')) {\n      event.preventDefault();\n    }\n  }\n\n  @HostListener('keyup', ['$event'])\n  public keyUp(event) {\n    if (event.key === 'Enter') {\n      const name = event.target.name;\n      if (name) {\n        this.do(event, name);\n      }\n    }\n  }\n\n  @ViewChild('dropdown', {\n    read: ViewContainerRef,\n    static: true,\n  })\n  viewContainerRef: ViewContainerRef\n\n  public do(event, action) {\n    event.preventDefault();\n    event.stopPropagation();\n    if (this.controller.getAction(action).dropdown) {\n      if (action === this.dropdownAction) {\n        this.dropdownAction = false;\n      } else {\n        let button = event.target;\n        if (!button.classList.contains('fate-ui-button')) {\n          button = button.closest('.fate-ui-button');\n        }\n        if(!button) {\n          return\n        }\n        const dropdown =  this.el.nativeElement.querySelector('.fate-ui-dropdown');\n\n        // Enable the dropdown\n\n        this.dropdownValue = this.enabled[action];\n        console.debug('action has value', button, dropdown, this.dropdownValue);\n        this.initDropdown(this.controller.getAction(action).dropdown, this.dropdownValue);\n\n        // Postion the dropdown\n        setTimeout(() => {\n          const buttonSize = button.getBoundingClientRect();\n          const dropdownSize =  dropdown.getBoundingClientRect();\n          let leftPosition = button.offsetLeft + (buttonSize.width / 2) - (dropdownSize.width / 2);\n          // make sure the dropdown is not bleeding out of the viewport\n          if (buttonSize.left + window.pageXOffset + (buttonSize.width / 2) - (dropdownSize.width / 2) < 3) {\n            leftPosition = - buttonSize.left - window.pageXOffset + button.offsetLeft + 3;\n          } else if (buttonSize.left + window.pageXOffset + (buttonSize.width / 2) + (dropdownSize.width / 2) > window.innerWidth - 3) {\n            leftPosition = window.innerWidth - buttonSize.left - window.pageXOffset + button.offsetLeft - dropdownSize.width - 3;\n          }\n          const topPosition = button.offsetTop + buttonSize.height - 3;\n          dropdown.style.left = leftPosition + 'px';\n          dropdown.style.top = topPosition + 'px';\n          // make the dropdown visible\n          this.dropdownAction = action;\n        }, 0);\n      }\n    } else {\n      this.dropdownAction = false;\n      this.controller.do(this.uiId, action);\n    }\n  }\n\n  protected getOffset(element) {\n    let top = 0;\n    let left = 0;\n    do {\n        top += element.offsetTop  || 0;\n        left += element.offsetLeft || 0;\n        element = element.offsetParent;\n    } while (element);\n\n    return {\n        top: top,\n        left: left\n    };\n  }\n\n  protected initDropdown(actionComponent, value) {\n    if (this.dropdownComponent) {\n      this.dropdownComponent.destroy();\n    }\n    const factory = this.factoryResolver.resolveComponentFactory(actionComponent);\n    const component: any = factory.create(this.viewContainerRef.parentInjector);\n    if (component.instance.valueChange) {\n      component.instance.value = value;\n      component.instance.valueChange.subscribe((newValue) => {\n        this.dropdownValue = newValue;\n        this.controller.do(this.uiId, this.dropdownAction, newValue);\n      });\n      this.dropdownComponent = this.viewContainerRef.insert(component.hostView);\n    } else {\n      throw new Error('The component used as a dropdown doesn\\'t contain a valueChange emmiter!');\n    }\n  }\n\n  public ngOnChanges(changes) {\n    if (changes['uiId']) {\n      if (this.inputSubscription) {\n        this.inputSubscription.unsubscribe();\n      }\n      this.inputSubscription = this.controller.enabled(this.uiId).subscribe((actions: any) => {\n        this.enabled = {};\n        for (const action of actions) {\n          this.enabled[action.action] = action.value || true;\n        }\n      });\n    }\n  }\n\n  public ngAfterViewInit() {\n    const handle = window.addEventListener('mousedown', (event) => {\n      if (!(event.target as Element).closest('.fate-ui-dropdown')) {\n        this.dropdownAction = false;\n      }\n    });\n  }\n}\n","import {\n  Component,\n  Input,\n  Output,\n  ViewChild,\n  ElementRef,\n  ViewRef,\n  ViewContainerRef,\n  ComponentFactoryResolver,\n  OnInit,\n  OnChanges,\n  AfterViewInit,\n  OnDestroy,\n  EventEmitter,\n  Renderer2,\n  SimpleChanges,\n  Inject\n} from '@angular/core';\nimport { DOCUMENT } from '@angular/common';\nimport { NG_VALUE_ACCESSOR, ControlValueAccessor } from '@angular/forms';\nimport { DomSanitizer, SafeHtml } from '@angular/platform-browser';\n\nimport { Subscription } from 'rxjs';\n\nimport { FateControllerService } from '../fate-controller.service';\nimport { FateHtmlParserService } from '../fate-html-parser.service';\nimport { FateParserService } from '../fate-parser.service';\n\n@Component({\n  selector: 'fate-input',\n  template: `\n    <div\n      class=\"fate-inline-dropdown\"\n      [class.hidden]=\"!inlineAction\"\n      [class.contextual]=\"inlineAction?.display === 'contextual'\"\n      [style.top]=\"dropdownPostionTop\"\n      [style.left]=\"dropdownPostionLeft\"\n    >\n      <ng-template #dropdown></ng-template>\n    </div>\n    <div\n      #editTarget\n      [class]=\"'fate-edit-target ' + customClass\"\n      [ngClass]=\"{ empty: empty }\"\n      contenteditable=\"true\"\n      [title]=\"placeholder\"\n      [innerHtml]=\"content\"\n    ></div>\n  `,\n  styles: [\n    `\n      :host div.fate-edit-target {\n        display: block;\n        padding: 10px;\n        border: 1px solid #ddd;\n        outline: 0;\n        resize: vertical;\n        overflow: auto;\n        background: #fff;\n        color: #000;\n        overflow: visible;\n      }\n      :host div.fate-edit-target.empty:not(:focus):before {\n        content: attr(title);\n        color: #636c72;\n      }\n      .fate-inline-dropdown {\n        border: 1px solid #ddd;\n        border-bottom: 0;\n      }\n      .fate-inline-dropdown.hidden {\n        display: none !important;\n      }\n      .fate-inline-dropdown.contextual {\n        position: absolute;\n        background: #fff;\n        box-shadow: 0 5px 30px -10px rgba(0, 0, 0, 0.4);\n        border-bottom: 1px solid #ccc;\n      }\n      :host {\n        margin-bottom: 10px;\n        /*position: relative;*/\n      }\n    `\n  ],\n  providers: [\n    { provide: NG_VALUE_ACCESSOR, useExisting: FateInputComponent, multi: true }\n  ]\n})\nexport class FateInputComponent\n  implements ControlValueAccessor, OnChanges, OnInit, AfterViewInit, OnDestroy {\n  @Input()\n  public uiId: string = 'default';\n\n  @Input()\n  public row: number;\n\n  @Input()\n  public customClass: string;\n\n  @Input()\n  public placeholder: string = '';\n\n  @Input()\n  public initialFocus: boolean = false;\n\n  @Output()\n  public focus = new EventEmitter<void>();\n\n  @Output()\n  public blur = new EventEmitter<void>();\n\n  public dropdownPostionTop: string;\n  public dropdownPostionLeft: string;\n  public inlineAction: any;\n  public content: SafeHtml;\n  public empty: boolean = true;\n\n  @ViewChild('dropdown', {\n    read: ViewContainerRef,\n    static: true\n  })\n  viewContainerRef: ViewContainerRef;\n\n  @ViewChild('editTarget', { static: true })\n  protected set editTargetElementRef(elementRef: ElementRef<HTMLElement>) {\n    this.editTarget = elementRef.nativeElement;\n  }\n\n  protected dropdownComponent: ViewRef;\n  protected dropdownInstance: any;\n  protected editTarget: HTMLElement;\n\n  protected isFocused: boolean = false;\n\n  private _unlisteners: (() => void)[] = [];\n  private set unlisteners(handler: () => void) {\n    this._unlisteners.push(handler);\n  }\n\n  constructor(\n    protected el: ElementRef,\n    protected controller: FateControllerService,\n    protected htmlParser: FateHtmlParserService,\n    protected parser: FateParserService,\n    protected sanitizer: DomSanitizer,\n    protected factoryResolver: ComponentFactoryResolver,\n    private renderer: Renderer2,\n    @Inject(DOCUMENT) private document: any\n  ) {}\n\n  private unlisten() {\n    for (const handler of this._unlisteners) {\n      handler();\n    }\n  }\n\n  private reactToChanges() {\n    const tree = this.htmlParser.parseElement(this.editTarget);\n    const serializedTree = this.parser.serialize(tree);\n    this.changed.forEach(f => f(serializedTree));\n  }\n\n  public ngOnInit() {\n    this.subscribeToUi(this.uiId);\n  }\n\n  public ngAfterViewInit() {\n    if (this.row) {\n      this.computeHeight();\n    }\n\n    this.unlisteners = this.renderer.listen(\n      this.editTarget,\n      'click',\n      (event: MouseEvent) => {\n        console.debug('click');\n        // On click we save the text Selection\n        this.saveSelection();\n        // We check if there is a dropdown matching this context\n        this.checkForDropdownContext();\n      }\n    );\n\n    this.unlisteners = this.renderer.listen(\n      this.editTarget,\n      'keyup',\n      (event: KeyboardEvent) => {\n        console.debug('keypressed');\n        // On click we save the text Selection\n        this.saveSelection();\n        // We check if there is a dropdown matching this context\n        this.checkForDropdownContext();\n      }\n    );\n\n    this.unlisteners = this.renderer.listen(\n      this.editTarget,\n      'focus',\n      (event: FocusEvent) => {\n        console.debug('(' + this.uiId + ') focus');\n        // On focus we restore it\n        this.restoreSelection();\n        this.isFocused = true;\n        this.focus.emit();\n      }\n    );\n    this.unlisteners = this.renderer.listen(\n      this.editTarget,\n      'blur',\n      (event: FocusEvent) => {\n        console.debug('(' + this.uiId + ') blur');\n        this.isFocused = false;\n        this.blur.emit();\n        this.saveSelection();\n\n        if (this.dropdownComponent) {\n          setTimeout(() => {\n            this.inlineAction = null;\n            this.dropdownComponent.destroy();\n          }, 300);\n          // this.inlineAction = null;\n          // this.dropdownComponent.destroy();\n        }\n      }\n    );\n\n    this.unlisteners = this.renderer.listen(\n      this.editTarget,\n      'keydown',\n      (event: KeyboardEvent) => {\n        console.debug('keydown', event);\n        const stopDefault = () => {\n          event.preventDefault();\n          event.stopPropagation();\n        };\n        const stopDefaultAndForceUpdate = () => {\n          stopDefault();\n          this.checkEmpty();\n          this.reactToChanges();\n        };\n        // This is needed because, if the current selection is part\n        // of a non-editable child of the input, the default delete won't\n        // work.\n        // This case can happen if there is a cutom element that\n        // was inserted by some custom controller.\n        //\n        // Some constraints for a custom block to work on top of contenteditable=false:\n        // -moz-user-select: none;\n        // -webkit-user-modify: read-only;\n        //\n        // Note: It may make sense to delete the selection for normal text\n        // input too but for now we only do it on deletion.\n        if (\n          event.key === 'Backspace' ||\n          (event.key === 'Delete' && this.selectionRange)\n        ) {\n          const node = this.selectionRange.commonAncestorContainer;\n          console.debug('Deletion', node);\n          if (\n            node instanceof HTMLElement &&\n            !(node as HTMLElement).isContentEditable\n          ) {\n            // this is the case on firefox\n            console.debug('deleting inside un-editable block detected');\n            this.selectionRange.selectNode(node);\n            this.selectionRange.deleteContents();\n            stopDefaultAndForceUpdate();\n          } else if (\n            node.nodeName === '#text' &&\n            !node.parentElement.isContentEditable\n          ) {\n            // this is the case on webkit\n            console.debug('deleting inside un-editable block detected');\n            this.selectionRange.selectNode(node.parentElement);\n            this.selectionRange.deleteContents();\n            stopDefaultAndForceUpdate();\n          }\n        }\n        // This is needed because, there is a bug in Firefox that prevent\n        // deleting a uneditable element inside an editable element. So we\n        // reimplement the whole function for all browsers.\n        if (event.key === 'Backspace' && this.selectionRange) {\n          const node = this.selectionRange.commonAncestorContainer;\n          if (\n            this.selectionRange.collapsed === true &&\n            this.selectionRange.startOffset === 0 &&\n            node.previousSibling instanceof HTMLElement &&\n            !(node.previousSibling as HTMLElement).isContentEditable\n          ) {\n            node.previousSibling.remove();\n            stopDefaultAndForceUpdate();\n          }\n        } else if (event.key === 'Delete' && this.selectionRange) {\n          const node = this.selectionRange.commonAncestorContainer;\n          if (\n            this.selectionRange.collapsed === true &&\n            this.selectionRange.endContainer.nodeName === '#text' &&\n            this.selectionRange.endOffset ===\n              (this.selectionRange.endContainer as Text).length &&\n            node.nextSibling instanceof HTMLElement &&\n            !(node.nextSibling as HTMLElement).isContentEditable\n          ) {\n            node.nextSibling.remove();\n            stopDefaultAndForceUpdate();\n          }\n        }\n        // If a dropdown is currently being displayed we use the up/down\n        // key to navigate its content and return to select the selected\n        // element\n        if (this.inlineAction) {\n          if (event.key === 'Up' || event.key === 'ArrowUp') {\n            stopDefault();\n            this.dropdownInstance.selecPrevious();\n          } else if (event.key === 'Down' || event.key === 'ArrowDown') {\n            stopDefault();\n            this.dropdownInstance.selectNext();\n          } else if (event.key === 'Enter') {\n            stopDefault();\n            this.dropdownInstance.confirmSelection();\n          }\n        }\n      }\n    );\n\n    this.unlisteners = this.renderer.listen(\n      this.editTarget,\n      'input',\n      (event: InputEvent) => {\n        console.debug('value changed');\n        this.checkEmpty();\n        this.reactToChanges();\n      }\n    );\n\n    // const style: CSSStyleDeclaration = window.getComputedStyle(this.editTarget);\n    this.renderer.setStyle(this.editTarget, 'min-height', this.getHeight(2));\n\n    if (this.initialFocus) {\n      Promise.resolve(null).then(() => this.editTarget.focus());\n    }\n  }\n\n  public ngOnChanges(changes: SimpleChanges) {\n    if (changes.uiId) {\n      this.subscribeToUi(this.uiId);\n    }\n    if (changes.row) {\n      if (this.editTarget) {\n        this.computeHeight();\n      }\n    }\n  }\n\n  public ngOnDestroy() {\n    if (this.uiSubscription) {\n      this.uiSubscription.unsubscribe();\n    }\n    this.unlisten();\n  }\n\n  protected computeHeight() {\n    this.renderer.setStyle(this.editTarget, 'height', this.getHeight(this.row));\n  }\n\n  protected checkEmpty() {\n    if (this.editTarget.innerHTML === '') {\n      this.renderer.setAttribute(this.editTarget, 'innerHTML', '<br>');\n      this.empty = true;\n    } else if (this.editTarget.innerHTML === '<br>') {\n      this.empty = true;\n    } else {\n      this.empty = false;\n    }\n  }\n\n  protected getHeight(rowCount: number) {\n    const style: CSSStyleDeclaration = window.getComputedStyle(this.editTarget);\n    let height = parseInt(style.lineHeight, 10) * rowCount;\n\n    if (style.boxSizing === 'border-box') {\n      height +=\n        parseInt(style.paddingTop, 10) +\n        parseInt(style.paddingBottom, 10) +\n        parseInt(style.borderTopWidth, 10) +\n        parseInt(style.borderBottomWidth, 10);\n    }\n    return height + 'px';\n  }\n\n  protected uiSubscription: Subscription;\n  protected subscribeToUi(uiId: string) {\n    console.debug('subscribing to ' + uiId, this.uiSubscription);\n    if (this.uiSubscription) {\n      this.uiSubscription.unsubscribe();\n    }\n    this.uiSubscription = this.controller.channel(uiId).subscribe(command => {\n      // if input is not on focus we save current focused element:\n      const activeElement: Element = this.document.activeElement;\n      console.debug(\n        '(' + uiId + ') got command ' + command.name + '/' + command.value\n      );\n\n      this.restoreSelection();\n      if (command.name === 'insertHTML' && this.selectionRange) {\n        // If something is selected we assume that the goal is to replace it,\n        // so first we delete the content\n        this.selectionRange.deleteContents();\n        // insertHtml seems quite broken so we do it ourseleves\n        this.selectionRange.insertNode(\n          this.document.createRange().createContextualFragment(command.value)\n        );\n        // move cusor to the end of the newly inserted element\n        this.selectionRange.collapse(false);\n        // Force the update of the model\n        this.checkEmpty();\n        this.reactToChanges();\n      } else {\n        this.document.execCommand(command.name, false, command.value);\n      }\n      this.saveSelection();\n      if (activeElement instanceof HTMLElement) {\n        activeElement.focus();\n      }\n    });\n  }\n\n  // Saves the current text selection\n  protected selectionRange: Range;\n  protected saveSelection() {\n    if (this.selectionInEditableTarget()) {\n      const sel = window.getSelection();\n      if (sel.getRangeAt && sel.rangeCount) {\n        this.selectionRange = sel.getRangeAt(0);\n        console.debug('(' + this.uiId + ') saveSelection', this.selectionRange);\n        this.detectStyle();\n      }\n    }\n  }\n  // Restors the current text selection\n  protected restoreSelection() {\n    if (this.selectionInEditableTarget()) {\n      return;\n    }\n    console.debug('(' + this.uiId + ') restoreSelection', this.selectionRange);\n    if (this.selectionRange) {\n      const sel = window.getSelection();\n      sel.removeAllRanges();\n      sel.addRange(this.selectionRange);\n    }\n  }\n\n  protected selectionInEditableTarget() {\n    const sel = window.getSelection();\n    const node =\n      sel.getRangeAt &&\n      sel.rangeCount &&\n      sel.getRangeAt(0) &&\n      sel.getRangeAt(0).commonAncestorContainer;\n    return (\n      node &&\n      (node === this.editTarget ||\n        (node.parentElement.closest('.fate-edit-target') &&\n          node.parentElement.closest('.fate-edit-target') === this.editTarget))\n    );\n  }\n\n  protected detectStyle() {\n    let node = this.selectionRange.commonAncestorContainer;\n    if (\n      !node ||\n      !(\n        node.parentElement.closest('.fate-edit-target') &&\n        node !== this.editTarget\n      )\n    ) {\n      // The current selection is not contained in the editable zone.\n      // this is most likely due to the input being empty.\n      return;\n    }\n    // special cases for FF when selection is obtained by double click:\n    if (\n      this.selectionRange.endOffset === 0 &&\n      this.selectionRange.startContainer.nodeValue &&\n      this.selectionRange.startOffset ===\n        this.selectionRange.startContainer.nodeValue.length\n    ) {\n      node = this.selectionRange.startContainer.nextSibling;\n    } else if (\n      this.selectionRange.endOffset === 0 &&\n      this.selectionRange.startOffset === 0\n    ) {\n      node = this.selectionRange.startContainer.parentElement;\n    } else if (\n      this.selectionRange.commonAncestorContainer === this.editTarget &&\n      this.selectionRange.startContainer === this.editTarget &&\n      this.selectionRange.endContainer === this.editTarget\n    ) {\n      node = this.selectionRange.commonAncestorContainer.childNodes[\n        this.selectionRange.startOffset\n      ];\n    }\n    if (node && node !== this.editTarget) {\n      const nodes = this.htmlParser.findParentNodes(node, this.editTarget);\n      console.debug('  -> detected actions: ', nodes);\n      this.controller.enableActions(this.uiId, nodes);\n    }\n  }\n\n  // implentation of ControlValueAccessor:\n  protected changed = new Array<(value: string) => void>();\n\n  public writeValue(value: string) {\n    if (value) {\n      this.content = this.sanitizer.bypassSecurityTrustHtml(\n        this.htmlParser.serialize(this.parser.parse(value))\n      );\n      this.empty = false;\n    } else {\n      this.content = this.sanitizer.bypassSecurityTrustHtml('<br>');\n      this.empty = true;\n    }\n    this.selectionRange = undefined;\n  }\n\n  public registerOnChange(fn: (value: string) => void) {\n    this.changed.push(fn);\n  }\n\n  public registerOnTouched(fn: () => void) {}\n\n  protected checkForDropdownContext() {\n    const startPos = Math.max(this.selectionRange.startOffset - 20, 0);\n    const length = this.selectionRange.startOffset - startPos;\n    const context = this.selectionRange.startContainer.textContent.substr(\n      startPos,\n      length\n    );\n\n    const inlineAction = this.controller.getInlineAction(context);\n    if (inlineAction) {\n      if (\n        !this.inlineAction ||\n        this.inlineAction.dropdown !== inlineAction.dropdown\n      ) {\n        this.inlineAction = inlineAction;\n        this.initDropdown(\n          inlineAction,\n          this.selectionRange.getBoundingClientRect()\n        );\n      } else {\n        this.inlineAction = inlineAction;\n        this.updateDropdown(inlineAction.matched);\n      }\n    } else if (this.dropdownComponent) {\n      this.inlineAction = null;\n      this.dropdownComponent.destroy();\n    }\n  }\n\n  protected initDropdown(actionComponent, position) {\n    // set the dropdown component\n    if (this.dropdownComponent) {\n      this.dropdownComponent.destroy();\n    }\n    const factory = this.factoryResolver.resolveComponentFactory(\n      actionComponent.dropdown\n    );\n    const component: any = factory.create(this.viewContainerRef.parentInjector);\n    if (component.instance.valueChange) {\n      component.instance.value = actionComponent.matched;\n      component.instance.valueChange.subscribe(value => {\n        this.editTarget.focus();\n        const end = this.selectionRange.endOffset;\n        this.selectionRange.setStart(\n          this.selectionRange.endContainer,\n          end - actionComponent.matched.length\n        );\n        this.controller.doInline(this.uiId, this.inlineAction, value);\n        // delete the dropdown\n        this.inlineAction = null;\n        this.dropdownComponent.destroy();\n      });\n      this.dropdownComponent = this.viewContainerRef.insert(component.hostView);\n      this.dropdownInstance = component.instance;\n      this.updateDropdownPosition();\n    } else {\n      throw new Error(\n        'The component used as a dropdown doesn\\'t contain a valueChange emmiter!'\n      );\n    }\n  }\n\n  protected updateDropdown(value) {\n    this.dropdownInstance.value = value;\n    this.updateDropdownPosition();\n  }\n\n  protected updateDropdownPosition() {\n    if (this.inlineAction.display === 'contextual') {\n      // create a selection to get the size of the matching text\n      const parentOffsetBB = this.el.nativeElement.offsetParent.getBoundingClientRect();\n      const range = this.selectionRange.cloneRange();\n      const end = range.endOffset;\n      range.setStart(\n        range.endContainer,\n        end - this.inlineAction.matched.length\n      );\n      const boundingBox = range.getBoundingClientRect();\n      this.dropdownPostionTop =\n        boundingBox.top + boundingBox.height - parentOffsetBB.top + 'px';\n      this.dropdownPostionLeft = boundingBox.left - parentOffsetBB.left + 'px';\n    }\n  }\n}\n","import { Component, Input, ElementRef, HostListener, ComponentFactoryResolver } from '@angular/core';\nimport { NG_VALUE_ACCESSOR, ControlValueAccessor } from '@angular/forms';\n\nimport { defaultButtons } from '../fate-ui/fate-ui.component';\nimport { FateControllerService } from '../fate-controller.service';\nimport { FateParserService } from '../fate-parser.service';\nimport { FateIconService } from '../fate-icon.service';\n\nlet instanceCounter = 0;\n\n@Component({\n  selector: 'fate-bootstrap',\n  templateUrl: './fate-bootstrap.component.html',\n  styleUrls: ['./fate-bootstrap.component.scss'],\n  providers: [\n    {provide: NG_VALUE_ACCESSOR, useExisting: FateBootstrapComponent, multi: true}\n  ],\n})\nexport class FateBootstrapComponent implements ControlValueAccessor {\n\n  @Input()\n  row: number;\n\n  @Input()\n  placeholder: string;\n\n  @Input()\n  public buttons: Array<string> = defaultButtons;\n\n  // implentation of ControlValueAccessor:\n  protected changed = new Array<(value: string) => void>();\n  protected clickOngoing: boolean = false;\n\n  public passthrough: string;\n  public uiId;\n  public uiVisible;\n\n\n  @HostListener('focusout', ['$event'])\n  public blur (event: any) {\n    if (!this.clickOngoing) {\n      this.uiVisible = false;\n    }\n  }\n\n  @HostListener('mousedown', ['$event'])\n  public mousedown (event: any) {\n    this.clickOngoing = true;\n  }\n\n  @HostListener('mouseup', ['$event'])\n  public mouseup (event: any) {\n    this.clickOngoing = false;\n  }\n\n  @HostListener('focusin', ['$event'])\n  public focus (event: any) {\n    this.uiVisible = true;\n    console.info('boostrap focus!')\n  }\n\n  constructor(el: ElementRef, controller: FateControllerService, parser: FateParserService, icon: FateIconService, factoryResolver: ComponentFactoryResolver) {\n    this.uiId = 'bootstrap-' + (instanceCounter++);\n  }\n\n  public writeValue(value: string) {\n    this.passthrough = value;\n  }\n\n  public registerOnChange(fn: (value: string) => void) {\n    this.changed.push(fn);\n  }\n\n  public registerOnTouched(fn: () => void) {}\n\n  // change callback\n  public onChange(value) {\n    this.passthrough = value;\n    this.changed.forEach(f => f(value));\n  }\n}\n","import { Injectable } from '@angular/core';\n\nimport { FateIconService } from './fate-icon.service';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class FateMaterialIconService extends FateIconService {}\n","import { Component, Input, HostBinding, HostListener, Optional, Self, ElementRef, OnDestroy } from '@angular/core';\nimport { ControlValueAccessor, NgControl } from '@angular/forms';\nimport { MatFormFieldControl } from '@angular/material/form-field';\nimport { coerceBooleanProperty } from '@angular/cdk/coercion';\n\nimport { defaultButtons } from '../fate-ui/fate-ui.component';\nimport { FateControllerService } from '../fate-controller.service';\nimport { FateParserService } from '../fate-parser.service';\nimport { FateIconService } from '../fate-icon.service';\nimport { FateMaterialIconService } from '../fate-material-icon.service';\n\nimport { Subject } from 'rxjs';\n\nlet instanceCounter = 0;\n\n@Component({\n  selector: 'fate-material',\n  templateUrl: './fate-material.component.html',\n  styleUrls: ['./fate-material.component.scss'],\n  providers: [\n    { provide: MatFormFieldControl, useExisting: FateMaterialComponent },\n    { provide: FateIconService, useClass: FateMaterialIconService }\n  ],\n})\nexport class FateMaterialComponent implements  ControlValueAccessor, OnDestroy, MatFormFieldControl<string>  {\n\n  @Input()\n  row: number;\n\n  @Input()\n  public buttons: Array<string> = defaultButtons;\n\n  @Input()\n  public get value(): string {\n    return this.passthrough;\n  }\n  public set value(value: string) {\n    this.stateChanges.next();\n    this.passthrough = value;\n    this.changed.forEach(f => f(value));\n  }\n  public passthrough: string;\n\n  @Input()\n  get placeholder() {\n    return this._placeholder;\n  }\n  set placeholder(placeholder) {\n    this._placeholder = placeholder;\n    this.stateChanges.next();\n  }\n  protected _placeholder: string;\n\n  public uiId;\n  @HostBinding()\n  id = `${this.uiId}`;\n\n  @HostListener('focusout')\n  public blur() {\n    this.focused = false;\n    this.stateChanges.next();\n    if (!this.clickOngoing) {\n      this.uiVisible = false;\n    }\n  }\n\n  @HostListener('focusin')\n  public focus() {\n    this.focused = true;\n    this.uiVisible = true;\n    this.stateChanges.next();\n  }\n\n  @HostListener('mousedown', ['$event'])\n  public mousedown (event: any) {\n    this.clickOngoing = true;\n  }\n\n  @HostListener('mouseup', ['$event'])\n  public mouseup (event: any) {\n    this.clickOngoing = false;\n  }\n  public clickOngoing = false;\n  public uiVisible = false;\n\n  get empty() {\n    return !this.passthrough || this.passthrough === '';\n  }\n\n  get shouldLabelFloat() {\n    return this.focused || !this.empty;\n  }\n\n  @Input()\n  get required() {\n    return this._required;\n  }\n  set required(req) {\n    this._required = coerceBooleanProperty(req);\n    this.stateChanges.next();\n  }\n  protected _required = false;\n\n  @Input()\n  get disabled() {\n    return this._disabled;\n  }\n  set disabled(dis) {\n    this._disabled = coerceBooleanProperty(dis);\n    this.stateChanges.next();\n  }\n  protected _disabled = false;\n\n  public errorState = false;\n\n  public controlType = 'fate-material';\n\n  @HostBinding('attr.aria-describedby')\n  describedBy = '';\n\n  public setDescribedByIds(ids: string[]) {\n    this.describedBy = ids.join(' ');\n  }\n\n  public onContainerClick(event: MouseEvent) {}\n\n  public stateChanges = new Subject<void>();\n  public focused = false;\n\n  protected changed = new Array<(value: string) => void>();\n\n  constructor(controller: FateControllerService, parser: FateParserService, icon: FateIconService, el: ElementRef, @Optional() @Self() public ngControl: NgControl) {\n    this.uiId = 'material-' + (instanceCounter++);\n    // Setting the value accessor directly (instead of using\n    // the providers) to avoid running into a circular import.\n    if (this.ngControl != null) {\n      this.ngControl.valueAccessor = this;\n    }\n  }\n\n  public onChange(value) {\n    this.passthrough = value;\n    this.changed.forEach(f => f(value));\n    this.stateChanges.next();\n  }\n\n  public ngOnDestroy() {\n    this.stateChanges.complete();\n  }\n\n  public writeValue(value: string) {\n    this.passthrough = value;\n    this.stateChanges.next();\n  }\n\n  public registerOnChange(fn: (value: string) => void) {\n    this.changed.push(fn);\n  }\n\n  public registerOnTouched(fn: () => void) {}\n}\n","import { Injectable } from '@angular/core';\n\nimport { FateIconService } from './fate-icon.service';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class FateFontawsomeLegacyIconService extends FateIconService {\n\n  protected iconMapping = {\n    'bold' : '<i class=\"fa fa-bold\"></i>',\n    'italic' : '<i class=\"fa fa-italic\"></i>',\n    'underline' : '<i class=\"fa fa-underline\"></i>',\n    'strike' : '<i class=\"fa fa-strikethrough\"></i>',\n    'subscript' :  '<i class=\"fa fa-subscript\"></i>',\n    'superscript' : '<i class=\"fa fa-superscript\"></i>',\n    'indent' : '<i class=\"fa fa-indent\"></i>',\n    'outdent' : '<i class=\"fa fa-outdent\"></i>',\n    'ordered' : '<i class=\"fa fa-list-ol\"></i>',\n    'unordered' : '<i class=\"fa fa-list-ul\"></i>',\n    'center' : '<i class=\"fa fa-align-center\"></i>',\n    'justify' : '<i class=\"fa fa-align-justify\"></i>',\n    'left' : '<i class=\"fa fa-align-left\"></i>',\n    'right' : '<i class=\"fa fa-align-right\"></i>',\n    'undo' : '<i class=\"fa fa-undo\"></i>',\n    'redo' : '<i class=\"fa fa-repeat\"></i>',\n    'clean' : '<i class=\"fa fa-eraser\"></i>',\n    'link' : '<i class=\"fa fa-link\"></i>',\n  };\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { MatFormFieldModule } from '@angular/material/form-field';\nimport { FontAwesomeModule } from '@fortawesome/angular-fontawesome';\n\nimport { FateUiComponent } from './fate-ui/fate-ui.component';\nimport { FateInputComponent } from './fate-input/fate-input.component';\nimport { FateBootstrapComponent } from './fate-bootstrap/fate-bootstrap.component';\nimport { FateMaterialComponent } from './fate-material/fate-material.component';\nimport { FateLinkDropdownComponent } from './fate-link-dropdown/fate-link-dropdown.component';\n\nexport { FateParser } from './fate-parser.interface';\nexport { FateIcon } from './fate-icon.interface';\nexport { FateDropdown } from './fate-dropdown.interface';\nexport { FateUiComponent } from './fate-ui/fate-ui.component';\nexport { FateInputComponent } from './fate-input/fate-input.component';\nexport { FateLinkDropdownComponent } from './fate-link-dropdown/fate-link-dropdown.component';\nexport { FateIconService } from './fate-icon.service';\nexport { FateMaterialIconService } from './fate-material-icon.service';\nexport { FateFontawsomeLegacyIconService } from './fate-fontawsome-legacy-icon.service';\nexport { FateParserService } from './fate-parser.service';\nexport { FateControllerService, FateCommand } from './fate-controller.service';\nexport { FateHtmlParserService } from './fate-html-parser.service';\nexport { FateNode } from './fate-node';\nexport { FateType } from './fate-type.enum';\n\n@NgModule({\n  declarations: [\n    FateInputComponent,\n    FateUiComponent,\n    FateBootstrapComponent,\n    FateLinkDropdownComponent\n  ],\n  imports: [CommonModule, FormsModule, MatFormFieldModule, FontAwesomeModule],\n  exports: [\n    FateUiComponent,\n    FateInputComponent,\n    FateBootstrapComponent,\n    FateLinkDropdownComponent\n  ]\n})\nexport class FateModule {}\n\n@NgModule({\n  declarations: [FateMaterialComponent],\n  imports: [CommonModule, FormsModule, MatFormFieldModule, FateModule],\n  exports: [FateMaterialComponent]\n})\nexport class FateMaterialModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n\nexport {FateBootstrapComponent as ɵa} from './app/fate-bootstrap/fate-bootstrap.component';\nexport {FateMaterialComponent as ɵb} from './app/fate-material/fate-material.component';"],"names":["instanceCounter"],"mappings":";;;;;;;;;;IAAY;AAAZ,WAAY,QAAQ;IAClB,yBAAa,CAAA;IACb,mCAAuB,CAAA;IACvB,+BAAmB,CAAA;IACnB,+BAAmB,CAAA;IACnB,+BAAmB,CAAA;IACnB,+BAAmB,CAAA;IACnB,+BAAmB,CAAA;IACnB,+BAAmB,CAAA;IACnB,2BAAe,CAAA;IACf,yBAAa,CAAA;IACb,yBAAa,CAAA;IACb,yBAAa,CAAA;IACb,mCAAuB,CAAA;IACvB,mCAAuB,CAAA;IACvB,uCAA2B,CAAA;IAC3B,2CAA+B,CAAA;IAC/B,6BAAiB,CAAA;IACjB,2BAAe,CAAA;IACf,mCAAuB,CAAA;IACvB,yBAAa,CAAA;IACb,qCAAyB,CAAA;IACzB,yCAA6B,CAAA;IAC7B,uCAA2B,CAAA;IAC3B,+BAAmB,CAAA;IACnB,yCAA6B,CAAA;IAC7B,6CAAiC,CAAA;IACjC,iCAAqB,CAAA;IACrB,6BAAiB,CAAA;IACjB,iCAAqB,CAAA;AACvB,CAAC,EA9BW,QAAQ,KAAR,QAAQ;;;ICSpB;QAMS,gBAAW,GAAG,IAAI,YAAY,EAAU,CAAC;KAUjD;IARQ,+CAAW,GAAlB,UAAoB,KAAK;QACvB,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;QACnB,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;KAC9B;IAEM,8CAAU,GAAjB,eAAuB;IAAA,CAAC;IACjB,iDAAa,GAApB,eAA0B;IAAA,CAAC;IACpB,oDAAgB,GAAvB,eAA6B;IAAA,CAAC;IAZ9B;QADC,KAAK,EAAE;4DACa;IAGrB;QADC,MAAM,EAAE;kEACuC;IANrC,yBAAyB;QALrC,SAAS,CAAC;YACT,QAAQ,EAAE,oBAAoB;YAC9B,uHAAkD;;SAEnD,CAAC;OACW,yBAAyB,CAgBrC;IAAD,gCAAC;CAhBD;;;IC4LE;;;QAnLU,kBAAa,GAAG;YACxB,IAAI,EAAE;gBACJ,OAAO,EAAE,MAAM;gBACf,IAAI,EAAE,MAAM;gBACZ,MAAM,EAAE,QAAQ,CAAC,IAAI;aACtB;YACD,MAAM,EAAE;gBACN,OAAO,EAAE,QAAQ;gBACjB,IAAI,EAAE,QAAQ;gBACd,MAAM,EAAE,QAAQ,CAAC,MAAM;aACxB;YACD,SAAS,EAAE;gBACT,OAAO,EAAE,WAAW;gBACpB,IAAI,EAAE,YAAY;gBAClB,MAAM,EAAE,QAAQ,CAAC,SAAS;aAC3B;YACD,MAAM,EAAE;gBACN,OAAO,EAAE,eAAe;gBACxB,IAAI,EAAE,gBAAgB;gBACtB,MAAM,EAAE,QAAQ,CAAC,aAAa;aAC/B;YACD,SAAS,EAAE;gBACT,OAAO,EAAE,WAAW;gBACpB,IAAI,EAAE,WAAW;gBACjB,KAAK,EAAE,KAAK;gBACZ,MAAM,EAAE,QAAQ,CAAC,SAAS;aAC3B;YACD,WAAW,EAAE;gBACX,OAAO,EAAE,aAAa;gBACtB,IAAI,EAAE,aAAa;gBACnB,KAAK,EAAE,KAAK;gBACZ,MAAM,EAAE,QAAQ,CAAC,WAAW;aAC7B;YACD,QAAQ,EAAE;gBACR,OAAO,EAAE,aAAa;gBACtB,KAAK,EAAE,IAAI;gBACX,IAAI,EAAE,YAAY;gBAClB,KAAK,EAAE,IAAI;gBACX,MAAM,EAAE,QAAQ,CAAC,OAAO;aACzB;YACD,QAAQ,EAAE;gBACR,OAAO,EAAE,aAAa;gBACtB,KAAK,EAAE,IAAI;gBACX,IAAI,EAAE,YAAY;gBAClB,KAAK,EAAE,IAAI;gBACX,MAAM,EAAE,QAAQ,CAAC,OAAO;aACzB;YACD,QAAQ,EAAE;gBACR,OAAO,EAAE,aAAa;gBACtB,KAAK,EAAE,IAAI;gBACX,IAAI,EAAE,YAAY;gBAClB,KAAK,EAAE,IAAI;gBACX,MAAM,EAAE,QAAQ,CAAC,OAAO;aACzB;YACD,QAAQ,EAAE;gBACR,OAAO,EAAE,aAAa;gBACtB,KAAK,EAAE,IAAI;gBACX,IAAI,EAAE,YAAY;gBAClB,KAAK,EAAE,IAAI;gBACX,MAAM,EAAE,QAAQ,CAAC,OAAO;aACzB;YACD,QAAQ,EAAE;gBACR,OAAO,EAAE,aAAa;gBACtB,KAAK,EAAE,IAAI;gBACX,IAAI,EAAE,YAAY;gBAClB,KAAK,EAAE,IAAI;gBACX,MAAM,EAAE,QAAQ,CAAC,OAAO;aACzB;YACD,QAAQ,EAAE;gBACR,OAAO,EAAE,aAAa;gBACtB,KAAK,EAAE,IAAI;gBACX,IAAI,EAAE,YAAY;gBAClB,KAAK,EAAE,IAAI;gBACX,MAAM,EAAE,QAAQ,CAAC,OAAO;aACzB;YACD,MAAM,EAAE;gBACN,OAAO,EAAE,aAAa;gBACtB,KAAK,EAAE,KAAK;gBACZ,IAAI,EAAE,QAAQ;gBACd,KAAK,EAAE,GAAG;aACX;YACD,MAAM,EAAE;gBACN,OAAO,EAAE,QAAQ;gBACjB,IAAI,EAAE,QAAQ;aACf;YACD,OAAO,EAAE;gBACP,OAAO,EAAE,SAAS;gBAClB,IAAI,EAAE,SAAS;aAChB;YACD,OAAO,EAAE;gBACP,OAAO,EAAE,mBAAmB;gBAC5B,IAAI,EAAE,cAAc;gBACpB,MAAM,EAAE,QAAQ,CAAC,YAAY;aAC9B;YACD,SAAS,EAAE;gBACT,OAAO,EAAE,qBAAqB;gBAC9B,IAAI,EAAE,cAAc;gBACpB,MAAM,EAAE,QAAQ,CAAC,cAAc;aAChC;YACD,MAAM,EAAE;gBACN,OAAO,EAAE,eAAe;gBACxB,IAAI,EAAE,QAAQ;gBACd,MAAM,EAAE,QAAQ,CAAC,YAAY;aAC9B;YACD,OAAO,EAAE;gBACP,OAAO,EAAE,aAAa;gBACtB,IAAI,EAAE,SAAS;gBACf,MAAM,EAAE,QAAQ,CAAC,OAAO;aACzB;YACD,IAAI,EAAE;gBACJ,OAAO,EAAE,aAAa;gBACtB,IAAI,EAAE,MAAM;gBACZ,MAAM,EAAE,QAAQ,CAAC,UAAU;aAC5B;YACD,KAAK,EAAE;gBACL,OAAO,EAAE,cAAc;gBACvB,IAAI,EAAE,OAAO;gBACb,MAAM,EAAE,QAAQ,CAAC,WAAW;aAC7B;YACD,IAAI,EAAE;gBACJ,OAAO,EAAE,MAAM;gBACf,IAAI,EAAE,MAAM;aACb;YACD,IAAI,EAAE;gBACJ,OAAO,EAAE,MAAM;gBACf,IAAI,EAAE,MAAM;aACb;YACD,KAAK,EAAE;gBACL,OAAO,EAAE,cAAc;gBACvB,IAAI,EAAE,kBAAkB;aACzB;YACD,IAAI,EAAE;gBACJ,OAAO,EAAE,YAAY;gBACrB,IAAI,EAAE,QAAQ;gBACd,IAAI,EAAE,MAAM;gBACZ,MAAM,EAAE,QAAQ,CAAC,IAAI;gBACrB,QAAQ,EAAE,yBAAyB;aACpC;SACF,CAAC;QAYQ,wBAAmB,GAAQ,EAAE,CAAC;QAqB9B,iBAAY,GAAG;YACvB,OAAO,EAAE,IAAI,OAAO,EAAe;SACpC,CAAC;QAEQ,mBAAc,GAAG;YACzB,OAAO,EAAE,IAAI,OAAO,EAAO;SAC5B,CAAC;KAEc;IAxCT,8CAAc,GAArB,UAAsB,IAAY,EAAE,MAAW;QAC7C,IAAI,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,EAAE;YAC5B,MAAM,IAAI,KAAK,CAAC,2BAA2B,GAAG,IAAI,GAAG,mBAAmB,CAAC,CAAC;SAC3E;aAAM;YACL,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,GAAG,MAAM,CAAC;SACnC;KACF;IACM,yCAAS,GAAhB,UAAiB,UAAU;QACzB,OAAO,IAAI,CAAC,aAAa,CAAC,UAAU,CAAC,IAAI,KAAK,CAAC;KAChD;IAGM,oDAAoB,GAA3B,UAA4B,IAAY,EAAE,MAAW;QACnD,IAAI,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,EAAE;YAClC,MAAM,IAAI,KAAK,CACb,kCAAkC,GAAG,IAAI,GAAG,mBAAmB,CAChE,CAAC;SACH;aAAM;YACL,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,GAAG,MAAM,CAAC;SACzC;KACF;IACM,+CAAe,GAAtB,UAAuB,OAAe;;;YACpC,KAAqB,IAAA,KAAA,SAAA,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAA,gBAAA,4BAAE;gBAAvD,IAAM,MAAM,WAAA;gBACf,IAAM,KAAK,GAAG,IAAI,CAAC,mBAAmB,CAAC,MAAM,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;gBACpE,IAAI,KAAK,EAAE;oBACT,IAAI,CAAC,mBAAmB,CAAC,MAAM,CAAC,CAAC,OAAO,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;oBACpD,OAAO,IAAI,CAAC,mBAAmB,CAAC,MAAM,CAAC,CAAC;iBACzC;aACF;;;;;;;;;QACD,OAAO,KAAK,CAAC;KACd;IAYM,uCAAO,GAAd,UAAe,SAAS;QACtB,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,EAAE;YACjC,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,GAAG,IAAI,OAAO,EAAe,CAAC;SAC3D;QACD,OAAO,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,CAAC;KACrC;IAEM,uCAAO,GAAd,UAAe,SAAS;QACtB,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,EAAE;YACnC,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,GAAG,IAAI,OAAO,EAAO,CAAC;SACrD;QACD,OAAO,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC;KACvC;IAEM,6CAAa,GAApB,UAAqB,SAAS,EAAE,KAAK;;QACnC,IAAM,OAAO,GAAe,EAAE,CAAC;;YAC/B,KAAmB,IAAA,UAAA,SAAA,KAAK,CAAA,4BAAA,+CAAE;gBAArB,IAAM,IAAI,kBAAA;gBACb,KAAK,IAAM,MAAM,IAAI,IAAI,CAAC,aAAa,EAAE;oBACvC,IACE,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC,MAAM;wBACjC,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC,MAAM,KAAK,IAAI,CAAC,IAAI,EAC/C;wBACA,OAAO,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,MAAM,EAAE,KAAK,EAAE,IAAI,CAAC,KAAK,EAAE,CAAC,CAAC;qBACrD;yBAAM,IACL,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC,MAAM;wBACjC,OAAO,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC,MAAM,KAAK,UAAU,EACvD;wBACA,IAAM,QAAQ,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;wBACzD,IAAI,QAAQ,EAAE;4BACZ,OAAO,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,MAAM,EAAE,KAAK,EAAE,QAAQ,CAAC,KAAK,EAAE,CAAC,CAAC;yBACzD;qBACF;iBACF;aACF;;;;;;;;;QACD,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;KAC9C;IAEM,kCAAE,GAAT,UAAU,OAAO,EAAE,MAAM,EAAE,KAAM;QAC/B,IAAI,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC,QAAQ,IAAI,CAAC,KAAK,EAAE;YACjD,IAAI,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC,IAAI,EAAE;gBACnC,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC;oBAC9B,IAAI,EAAE,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC,IAAI;oBACrC,KAAK,EAAE,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC,KAAK,IAAI,KAAK;iBACjD,CAAC,CAAC;aACJ;iBAAM;gBACL,MAAM,IAAI,KAAK,CAAC,UAAU,GAAG,MAAM,GAAG,+BAA+B,CAAC,CAAC;aACxE;SACF;aAAM;YACL,IACE,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC,KAAK;gBAChC,OAAO,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC,KAAK,KAAK,UAAU,EACtD;gBACA,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC;oBAC9B,IAAI,EAAE,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC,OAAO;oBACxC,KAAK,EAAE,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,KAAK,CAAC;iBAC/C,CAAC,CAAC;aACJ;iBAAM;gBACL,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC;oBAC9B,IAAI,EAAE,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC,OAAO;oBACxC,KAAK,EAAE,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC,KAAK,IAAI,KAAK;iBACjD,CAAC,CAAC;aACJ;SACF;KACF;IAEM,wCAAQ,GAAf,UAAgB,OAAO,EAAE,MAAM,EAAE,KAAM;QACrC,IAAI,MAAM,CAAC,QAAQ,IAAI,CAAC,KAAK,EAAE;YAC7B,IAAI,MAAM,CAAC,IAAI,EAAE;gBACf,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC;oBAC9B,IAAI,EAAE,MAAM,CAAC,IAAI;oBACjB,KAAK,EAAE,MAAM,CAAC,KAAK,IAAI,KAAK;iBAC7B,CAAC,CAAC;aACJ;iBAAM;gBACL,MAAM,IAAI,KAAK,CAAC,UAAU,GAAG,MAAM,GAAG,+BAA+B,CAAC,CAAC;aACxE;SACF;aAAM;YACL,IAAI,MAAM,CAAC,KAAK,IAAI,OAAO,MAAM,CAAC,KAAK,KAAK,UAAU,EAAE;gBACtD,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC;oBAC9B,IAAI,EAAE,MAAM,CAAC,OAAO;oBACpB,KAAK,EAAE,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC;iBAC3B,CAAC,CAAC;aACJ;iBAAM;gBACL,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC;oBAC9B,IAAI,EAAE,MAAM,CAAC,OAAO;oBACpB,KAAK,EAAE,MAAM,CAAC,KAAK,IAAI,KAAK;iBAC7B,CAAC,CAAC;aACJ;SACF;KACF;IAEM,oCAAI,GAAX,UAAY,OAAO,EAAE,MAAM,EAAE,KAAM;QACjC,IAAM,OAAO,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC;;KAEjD;;IArRU,qBAAqB;QAHjC,UAAU,CAAC;YACV,UAAU,EAAE,MAAM;SACnB,CAAC;OACW,qBAAqB,CAsRjC;gCArSD;CAeA;;;ICZE,kBAAmB,IAA8B,EAAS,KAAW;QAAlD,qBAAA,EAAA,OAAiB,QAAQ,CAAC,IAAI;QAA9B,SAAI,GAAJ,IAAI,CAA0B;QAAS,UAAK,GAAL,KAAK,CAAM;QAE9D,aAAQ,GAA6B,EAAE,CAAC;KAF0B;IAG3E,eAAC;AAAD,CAAC;;;ICIC;KAAiB;IAEV,qCAAK,GAAZ,UAAa,IAAY;QACvB,IAAM,GAAG,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QAC1C,GAAG,CAAC,SAAS,GAAG,IAAI,CAAC;QACrB,OAAO,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC;KAC/B;IAAA,CAAC;IAEK,4CAAY,GAAnB,UAAoB,OAAoB;QACtC,IAAM,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;QACtC,IAAI,WAAW,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;QAE3B,IAAI,QAAQ,IAAI,WAAW,CAAC,IAAI,KAAK,QAAQ,CAAC,SAAS,CAAC,CAAC;QACzD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACrC,WAAW,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;YACpC,WAAW,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;YACvB,IAAI,WAAW,CAAC,IAAI,KAAK,QAAQ,CAAC,SAAS,EAAE;gBAC3C,QAAQ,GAAG,IAAI,CAAC;aACjB;SACF;QAED,IAAI,mBAAmB,GAAG,KAAK,CAAC;QAChC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,CAAC,UAAU,CAAC,MAAM,EAAE,CAAC,EAAG,EAAE;YACnD,IAAM,KAAK,GAAG,OAAO,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;;YAEpC,IACI,CAAC,CAAC,GAAG,OAAO,CAAC,UAAU,CAAC,MAAM,GAAG,CAAC;iBACjC,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;gBAC7C,EAAE,QAAQ,IAAI,CAAC,KAAK,OAAO,CAAC,UAAU,CAAC,MAAM,GAAG,CAAC,CAAC;cAClD;gBAEF,mBAAmB,GAAG,KAAK,CAAC;gBAC5B,IAAI,KAAK,YAAY,IAAI,EAAE;;oBAEzB,IAAM,SAAS,GAAG,IAAI,QAAQ,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC;oBACnD,SAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;oBACpC,WAAW,CAAC,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;iBACtC;qBAAM,IAAI,KAAK,YAAY,WAAW,EAAE;;oBAEvC,WAAW,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC;oBACpD,WAAW,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,QAAQ,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,CAAC;iBAC7D;qBAAM;;iBAEN;aACF;iBAAM;gBACL,IAAI,KAAK,YAAY,IAAI,EAAE;;oBAEzB,IAAI,mBAAmB,EAAE;wBACvB,WAAW,CAAC,QAAQ,CAAC,WAAW,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC,GAAG,WAAW,CAAC,QAAQ,CAAC,WAAW,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC,GAAG,KAAK,CAAC,IAAI,CAAC;qBAC5H;yBAAM;wBACL,WAAW,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;qBACvC;oBACD,mBAAmB,GAAG,IAAI,CAAC;iBAC5B;qBAAM,IAAI,KAAK,YAAY,WAAW,EAAE;oBACvC,WAAW,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC;oBACpD,mBAAmB,GAAG,KAAK,CAAC;iBAC7B;qBAAM;;iBAEN;aACF;SACF;QACD,OAAO,KAAK,CAAC,CAAC,CAAC,CAAC;KACjB;IAEM,+CAAe,GAAtB,UAAuB,IAAU,EAAE,KAAW;QAC5C,IAAM,KAAK,GAAoB,EAAE,CAAC;QAClC,IAAI,OAAO,GAAgB,CAAC,IAAI,CAAC,QAAQ,KAAK,CAAC,IAAK,IAAoB,GAAG,IAAI,CAAC,aAAa,CAAC;QAC9F,OAAO,OAAO,KAAK,KAAK,EAAE;YACxB,KAAK,CAAC,IAAI,OAAV,KAAK,WAAS,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,GAAE;YACvC,OAAO,GAAG,OAAO,CAAC,aAAa,CAAC;SACjC;QACD,OAAO,KAAK,CAAC;KACd;IAES,iDAAiB,GAA3B,UAA4B,OAAoB;QAC9C,IAAM,KAAK,GAAG,OAAO,CAAC,KAAK,CAAC;QAC5B,IAAM,iBAAiB,GAAG,EAAE,CAAC;;QAE7B,IAAM,KAAK,GAAG,OAAO,CAAC,YAAY,CAAC,OAAO,CAAC,IAAI,KAAK,CAAC,SAAS,CAAC;QAC/D,QAAQ,KAAK;YACX,KAAK,MAAM;gBACT,iBAAiB,CAAC,IAAI,CAAC,IAAI,QAAQ,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC,CAAC;gBAC1D,MAAM;YACR,KAAK,QAAQ;gBACX,iBAAiB,CAAC,IAAI,CAAC,IAAI,QAAQ,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC,CAAC;gBAC5D,MAAM;YACR,KAAK,OAAO;gBACV,iBAAiB,CAAC,IAAI,CAAC,IAAI,QAAQ,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC,CAAC;gBAC3D,MAAM;YACR,KAAK,SAAS;gBACZ,iBAAiB,CAAC,IAAI,CAAC,IAAI,QAAQ,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC;gBACvD,MAAM;SACT;;QAED,IAAM,KAAK,GAAG,OAAO,CAAC,YAAY,CAAC,OAAO,CAAC,IAAI,KAAK,CAAC,KAAK,CAAC;QAC3D,IAAG,KAAK,EAAE;YACR,iBAAiB,CAAC,IAAI,CAAC,IAAI,QAAQ,CAAC,QAAQ,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC,CAAC;SAC7D;;QAED,IAAM,IAAI,GAAG,OAAO,CAAC,YAAY,CAAC,MAAM,CAAC,IAAI,KAAK,CAAC,QAAQ,CAAC;QAC5D,IAAI,IAAI,EAAE;YACR,iBAAiB,CAAC,IAAI,CAAC,IAAI,QAAQ,CAAC,QAAQ,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC,CAAC;SAC3D;;QAED,IAAM,QAAQ,GAAG,OAAO,CAAC,YAAY,CAAC,MAAM,CAAC,IAAI,KAAK,CAAC,UAAU,CAAC;QAClE,IAAI,QAAQ,EAAE;YACZ,iBAAiB,CAAC,IAAI,CAAC,IAAI,QAAQ,CAAC,QAAQ,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC,CAAC;SACnE;QAED,OAAO,iBAAiB,CAAC;KAC1B;IAES,yCAAS,GAAnB,UAAoB,OAAoB;QACtC,IAAM,cAAc,GAAG,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,CAAC;QACvD,QAAQ,OAAO,CAAC,QAAQ;YACtB,KAAK,IAAI;gBACP,iBAAQ,IAAI,QAAQ,CAAC,QAAQ,CAAC,OAAO,CAAC,GAAK,cAAc,EAAE;YAC7D,KAAK,IAAI;gBACP,iBAAQ,IAAI,QAAQ,CAAC,QAAQ,CAAC,OAAO,CAAC,GAAK,cAAc,EAAE;YAC7D,KAAK,IAAI;gBACP,iBAAQ,IAAI,QAAQ,CAAC,QAAQ,CAAC,OAAO,CAAC,GAAK,cAAc,EAAE;YAC7D,KAAK,IAAI;gBACP,iBAAQ,IAAI,QAAQ,CAAC,QAAQ,CAAC,OAAO,CAAC,GAAK,cAAc,EAAE;YAC7D,KAAK,IAAI;gBACP,iBAAQ,IAAI,QAAQ,CAAC,QAAQ,CAAC,OAAO,CAAC,GAAK,cAAc,EAAE;YAC7D,KAAK,IAAI;gBACP,iBAAQ,IAAI,QAAQ,CAAC,QAAQ,CAAC,OAAO,CAAC,GAAK,cAAc,EAAE;YAC7D,KAAK,GAAG,CAAC;YACT,KAAK,QAAQ;gBACX,OAAO,CAAC,IAAI,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;YACvC,KAAK,GAAG,CAAC;YACT,KAAK,IAAI;gBACP,OAAO,CAAC,IAAI,QAAQ,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC;YACzC,KAAK,GAAG;gBACN,OAAO,CAAC,IAAI,QAAQ,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,CAAC;YAC5C,KAAK,QAAQ;gBACX,OAAO,CAAC,IAAI,QAAQ,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC,CAAC;YAChD,KAAK,KAAK;gBACR,OAAO,CAAC,IAAI,QAAQ,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,CAAC;YAC5C,KAAK,KAAK;gBACR,OAAO,CAAC,IAAI,QAAQ,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC,CAAC;YAC9C,KAAK,GAAG;gBACN,OAAO,CAAC,IAAI,QAAQ,CAAC,QAAQ,CAAC,IAAI,EAAE,OAAO,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;YACrE,KAAK,IAAI;gBACP,OAAO,CAAC,IAAI,QAAQ,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC,CAAC;YAC/C,KAAK,IAAI;gBACP,OAAO,CAAC,IAAI,QAAQ,CAAC,QAAQ,CAAC,cAAc,CAAC,CAAC,CAAC;YACjD,KAAK,IAAI;gBACP,OAAO,CAAC,IAAI,QAAQ,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,CAAC;YAC3C,KAAK,KAAK,CAAC;YACX,KAAK,GAAG;gBACN,IAAI,cAAc,CAAC,MAAM,GAAG,CAAC,EAAE;oBAC7B,gBAAW,cAAc,EAAE;iBAC5B;gBACD,OAAO,CAAC,IAAI,QAAQ,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,CAAC;YAC5C,KAAK,YAAY;;gBAEf,IAAI,OAAO,CAAC,KAAK,CAAC,UAAU,KAAK,MAAM,EAAE;oBACvC,OAAO,CAAC,IAAI,QAAQ,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC;iBACxC;gBACD,OAAO,CAAC,IAAI,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;YACvC;gBACE,IAAI,cAAc,CAAC,MAAM,GAAG,CAAC,EAAE;oBAC7B,gBAAW,cAAc,EAAE;iBAC5B;gBACD,OAAO,CAAC,IAAI,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;SACxC;KACF;IAES,0CAAU,GAApB,UAAqB,OAAoB;QACvC,QAAQ,OAAO,CAAC,QAAQ;YACtB,KAAK,GAAG;gBACN,OAAO,OAAO,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC;SACvC;QACD,OAAO,SAAS,CAAC;KAClB;IAES,6CAAa,GAAvB,UAAwB,IAAc;QACpC,QAAQ,IAAI,CAAC,IAAI;YACf,KAAK,QAAQ,CAAC,SAAS;gBACrB,OAAO,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,IAAI,CAAC,GAAG,QAAQ,CAAC;YACzD,KAAK,QAAQ,CAAC,OAAO;gBACnB,OAAO,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,IAAI,CAAC,GAAG,OAAO,CAAC;YACvD,KAAK,QAAQ,CAAC,OAAO;gBACnB,OAAO,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,IAAI,CAAC,GAAG,OAAO,CAAC;YACvD,KAAK,QAAQ,CAAC,OAAO;gBACnB,OAAO,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,IAAI,CAAC,GAAG,OAAO,CAAC;YACvD,KAAK,QAAQ,CAAC,OAAO;gBACnB,OAAO,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,IAAI,CAAC,GAAG,OAAO,CAAC;YACvD,KAAK,QAAQ,CAAC,OAAO;gBACnB,OAAO,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,IAAI,CAAC,GAAG,OAAO,CAAC;YACvD,KAAK,QAAQ,CAAC,OAAO;gBACnB,OAAO,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,IAAI,CAAC,GAAG,OAAO,CAAC;YACvD,KAAK,QAAQ,CAAC,KAAK;gBACjB,OAAO,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,UAAU,CAAC;YACvD,KAAK,QAAQ,CAAC,IAAI;gBAChB,OAAO,QAAQ,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,SAAS,CAAC;YACrD,KAAK,QAAQ,CAAC,IAAI;gBAChB,OAAO,UAAU,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,WAAW,CAAC;YACzD,KAAK,QAAQ,CAAC,MAAM;gBAClB,OAAO,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,OAAO,CAAC;YACjD,KAAK,QAAQ,CAAC,SAAS;gBACrB,OAAO,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,MAAM,CAAC;YAC/C,KAAK,QAAQ,CAAC,aAAa;gBACzB,OAAO,UAAU,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,WAAW,CAAC;YACzD,KAAK,QAAQ,CAAC,SAAS;gBACrB,OAAO,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,QAAQ,CAAC;YACnD,KAAK,QAAQ,CAAC,WAAW;gBACvB,OAAO,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,QAAQ,CAAC;YACnD,KAAK,QAAQ,CAAC,IAAI;gBAChB,OAAO,WAAW,GAAG,IAAI,CAAC,KAAK,GAAG,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,MAAM,CAAC;YACzE,KAAK,QAAQ,CAAC,YAAY;gBACxB,OAAO,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,OAAO,CAAC;YACjD,KAAK,QAAQ,CAAC,cAAc;gBAC1B,OAAO,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,OAAO,CAAC;YACjD,KAAK,QAAQ,CAAC,QAAQ;gBACpB,OAAO,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,OAAO,CAAC;YACjD,KAAK,QAAQ,CAAC,UAAU;gBACtB,OAAO,iCAAiC,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,IAAI,CAAC,GAAG,QAAQ,CAAC;YACnF,KAAK,QAAQ,CAAC,YAAY;gBACxB,OAAO,mCAAmC,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,IAAI,CAAC,GAAG,QAAQ,CAAC;YACrF,KAAK,QAAQ,CAAC,WAAW;gBACvB,OAAO,iCAAiC,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,IAAI,CAAC,GAAG,QAAQ,CAAC;YACnF,KAAK,QAAQ,CAAC,OAAO;gBACnB,OAAO,oCAAoC,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,IAAI,CAAC,GAAG,QAAQ,CAAC;YACtF,KAAK,QAAQ,CAAC,MAAM;gBAClB,OAAO,wCAAwC,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,IAAI,CAAC,GAAG,eAAe,CAAC;YACjG,KAAK,QAAQ,CAAC,KAAK;gBACjB,OAAO,eAAe,GAAG,IAAI,CAAC,KAAK,GAAG,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,SAAS,CAAC;YAChF,KAAK,QAAQ,CAAC,IAAI;gBAChB,OAAO,cAAc,GAAG,IAAI,CAAC,KAAK,GAAG,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,SAAS,CAAC;YAC/E,KAAK,QAAQ,CAAC,QAAQ;gBACpB,OAAO,cAAc,GAAG,IAAI,CAAC,KAAK,GAAG,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,SAAS,CAAC;YAC/E,KAAK,QAAQ,CAAC,IAAI;gBAChB,OAAO,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;SAC/B;KACF;IAAA,CAAC;IAEQ,2CAAW,GAArB,UAAsB,KAAW;QAC/B,QAAQ,KAAK,YAAY,WAAW,IAAI,KAAK,CAAC,QAAQ,KAAK,IAAI,EAAE;KAClE;;IAGM,yCAAS,GAAhB,UAAkB,IAAc,EAAE,YAA6B;QAA/D,iBAaC;QAbiC,6BAAA,EAAA,oBAA6B;QAC7D,IAAI,UAAU,GAAG,EAAE,CAAC;QACpB,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAC,KAAK;YAC1B,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE;gBAC7B,UAAU,IAAI,KAAK,CAAC;aACrB;iBAAM;gBACL,UAAU,IAAI,KAAI,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;aACzC;SACF,CAAC,CAAC;QACH,IAAI,YAAY,IAAI,CAAC,UAAU,EAAE;YAC/B,UAAU,GAAG,MAAM,CAAC;SACrB;QACD,OAAO,UAAU,CAAC;KACnB;IAAA,CAAC;;IAlQS,qBAAqB;QAHjC,UAAU,CAAC;YACV,UAAU,EAAE,MAAM;SACnB,CAAC;OACW,qBAAqB,CAmQjC;gCA3QD;CAQA;;;ICAuC,qCAAqB;IAA5D;;KAAqF;;IAAxE,iBAAiB;QAH7B,UAAU,CAAC;YACV,UAAU,EAAE,MAAM;SACnB,CAAC;OACW,iBAAiB,CAAuD;4BARrF;CAQqF,CAA9C,qBAAqB;;;ICD5D;;QAEY,gBAAW,GAAQ;YAC3B,IAAI,EAAE,MAAM;YACZ,MAAM,EAAE,QAAQ;YAChB,SAAS,EAAE,WAAW;YACtB,MAAM,EAAE,eAAe;YACvB,SAAS,EAAE,WAAW;YACtB,WAAW,EAAE,aAAa;YAC1B,MAAM,EAAE,QAAQ;YAChB,OAAO,EAAE,SAAS;YAClB,OAAO,EAAE,SAAS;YAClB,SAAS,EAAE,SAAS;YACpB,MAAM,EAAE,cAAc;YACtB,OAAO,EAAE,eAAe;YACxB,IAAI,EAAE,YAAY;YAClB,KAAK,EAAE,aAAa;YACpB,IAAI,EAAE,UAAU;YAChB,IAAI,EAAE,UAAU;YAChB,KAAK,EAAE,QAAQ;YACf,IAAI,EAAE,MAAM;SACb,CAAC;KAKH;IAHQ,iCAAO,GAAd,UAAe,UAAU;QACvB,OAAO,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;KACrC;;IAzBU,eAAe;QAH3B,UAAU,CAAC;YACV,UAAU,EAAE,MAAM;SACnB,CAAC;OACW,eAAe,CA0B3B;0BAjCD;CAOA;;ACCO,IAAM,cAAc,GAAG;IAC5B,MAAM;IACN,QAAQ;IACR,WAAW;IACX,QAAQ;IACR,WAAW;IACX,WAAW;IACX,aAAa;IACb,MAAM;IACN,WAAW;IACX,UAAU;IACV,UAAU;IACV,UAAU;IACV,UAAU;IACV,UAAU;IACV,UAAU;IACV,QAAQ;IACR,WAAW;IACX,QAAQ;IACR,SAAS;IACT,SAAS;IACT,WAAW;IACX,WAAW;IACX,QAAQ;IACR,SAAS;IACT,MAAM;IACN,OAAO;IACP,WAAW;IACX,MAAM;IACN,MAAM;IACN,OAAO;CACR,CAAC;;IAsBA,yBAAsB,EAAc,EAAS,UAAiC,EAAS,IAAqB,EAAY,MAAyB,EAAY,eAAyC;QAAhL,OAAE,GAAF,EAAE,CAAY;QAAS,eAAU,GAAV,UAAU,CAAuB;QAAS,SAAI,GAAJ,IAAI,CAAiB;QAAY,WAAM,GAAN,MAAM,CAAmB;QAAY,oBAAe,GAAf,eAAe,CAA0B;QAZ/L,SAAI,GAAW,SAAS,CAAC;QAGzB,YAAO,GAAkB,cAAc,CAAC;QAExC,YAAO,GAAQ,EAAE,CAAC;QAClB,mBAAc,GAAqB,KAAK,CAAC;KAM2J;IAGpM,mCAAS,GAAhB,UAAiB,KAAK;QACpB,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,OAAO,CAAC,mBAAmB,CAAC,EAAE;YAC9C,KAAK,CAAC,cAAc,EAAE,CAAC;SACxB;KACF;IAGM,+BAAK,GAAZ,UAAa,KAAK;QAChB,IAAI,KAAK,CAAC,GAAG,KAAK,OAAO,EAAE;YACzB,IAAM,MAAI,GAAG,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC;YAC/B,IAAI,MAAI,EAAE;gBACR,IAAI,CAAC,EAAE,CAAC,KAAK,EAAE,MAAI,CAAC,CAAC;aACtB;SACF;KACF;IAQM,4BAAE,GAAT,UAAU,KAAK,EAAE,MAAM;QAAvB,iBA4CC;QA3CC,KAAK,CAAC,cAAc,EAAE,CAAC;QACvB,KAAK,CAAC,eAAe,EAAE,CAAC;QACxB,IAAI,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,QAAQ,EAAE;YAC9C,IAAI,MAAM,KAAK,IAAI,CAAC,cAAc,EAAE;gBAClC,IAAI,CAAC,cAAc,GAAG,KAAK,CAAC;aAC7B;iBAAM;gBACL,IAAI,QAAM,GAAG,KAAK,CAAC,MAAM,CAAC;gBAC1B,IAAI,CAAC,QAAM,CAAC,SAAS,CAAC,QAAQ,CAAC,gBAAgB,CAAC,EAAE;oBAChD,QAAM,GAAG,QAAM,CAAC,OAAO,CAAC,iBAAiB,CAAC,CAAC;iBAC5C;gBACD,IAAG,CAAC,QAAM,EAAE;oBACV,OAAM;iBACP;gBACD,IAAM,UAAQ,GAAI,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,aAAa,CAAC,mBAAmB,CAAC,CAAC;;gBAI3E,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;gBAC1C,OAAO,CAAC,KAAK,CAAC,kBAAkB,EAAE,QAAM,EAAE,UAAQ,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC;gBACxE,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,QAAQ,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC;;gBAGlF,UAAU,CAAC;oBACT,IAAM,UAAU,GAAG,QAAM,CAAC,qBAAqB,EAAE,CAAC;oBAClD,IAAM,YAAY,GAAI,UAAQ,CAAC,qBAAqB,EAAE,CAAC;oBACvD,IAAI,YAAY,GAAG,QAAM,CAAC,UAAU,IAAI,UAAU,CAAC,KAAK,GAAG,CAAC,CAAC,IAAI,YAAY,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC;;oBAEzF,IAAI,UAAU,CAAC,IAAI,GAAG,MAAM,CAAC,WAAW,IAAI,UAAU,CAAC,KAAK,GAAG,CAAC,CAAC,IAAI,YAAY,CAAC,KAAK,GAAG,CAAC,CAAC,GAAG,CAAC,EAAE;wBAChG,YAAY,GAAG,CAAE,UAAU,CAAC,IAAI,GAAG,MAAM,CAAC,WAAW,GAAG,QAAM,CAAC,UAAU,GAAG,CAAC,CAAC;qBAC/E;yBAAM,IAAI,UAAU,CAAC,IAAI,GAAG,MAAM,CAAC,WAAW,IAAI,UAAU,CAAC,KAAK,GAAG,CAAC,CAAC,IAAI,YAAY,CAAC,KAAK,GAAG,CAAC,CAAC,GAAG,MAAM,CAAC,UAAU,GAAG,CAAC,EAAE;wBAC3H,YAAY,GAAG,MAAM,CAAC,UAAU,GAAG,UAAU,CAAC,IAAI,GAAG,MAAM,CAAC,WAAW,GAAG,QAAM,CAAC,UAAU,GAAG,YAAY,CAAC,KAAK,GAAG,CAAC,CAAC;qBACtH;oBACD,IAAM,WAAW,GAAG,QAAM,CAAC,SAAS,GAAG,UAAU,CAAC,MAAM,GAAG,CAAC,CAAC;oBAC7D,UAAQ,CAAC,KAAK,CAAC,IAAI,GAAG,YAAY,GAAG,IAAI,CAAC;oBAC1C,UAAQ,CAAC,KAAK,CAAC,GAAG,GAAG,WAAW,GAAG,IAAI,CAAC;;oBAExC,KAAI,CAAC,cAAc,GAAG,MAAM,CAAC;iBAC9B,EAAE,CAAC,CAAC,CAAC;aACP;SACF;aAAM;YACL,IAAI,CAAC,cAAc,GAAG,KAAK,CAAC;YAC5B,IAAI,CAAC,UAAU,CAAC,EAAE,CAAC,IAAI,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;SACvC;KACF;IAES,mCAAS,GAAnB,UAAoB,OAAO;QACzB,IAAI,GAAG,GAAG,CAAC,CAAC;QACZ,IAAI,IAAI,GAAG,CAAC,CAAC;QACb,GAAG;YACC,GAAG,IAAI,OAAO,CAAC,SAAS,IAAK,CAAC,CAAC;YAC/B,IAAI,IAAI,OAAO,CAAC,UAAU,IAAI,CAAC,CAAC;YAChC,OAAO,GAAG,OAAO,CAAC,YAAY,CAAC;SAClC,QAAQ,OAAO,EAAE;QAElB,OAAO;YACH,GAAG,EAAE,GAAG;YACR,IAAI,EAAE,IAAI;SACb,CAAC;KACH;IAES,sCAAY,GAAtB,UAAuB,eAAe,EAAE,KAAK;QAA7C,iBAgBC;QAfC,IAAI,IAAI,CAAC,iBAAiB,EAAE;YAC1B,IAAI,CAAC,iBAAiB,CAAC,OAAO,EAAE,CAAC;SAClC;QACD,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,uBAAuB,CAAC,eAAe,CAAC,CAAC;QAC9E,IAAM,SAAS,GAAQ,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;QAC5E,IAAI,SAAS,CAAC,QAAQ,CAAC,WAAW,EAAE;YAClC,SAAS,CAAC,QAAQ,CAAC,KAAK,GAAG,KAAK,CAAC;YACjC,SAAS,CAAC,QAAQ,CAAC,WAAW,CAAC,SAAS,CAAC,UAAC,QAAQ;gBAChD,KAAI,CAAC,aAAa,GAAG,QAAQ,CAAC;gBAC9B,KAAI,CAAC,UAAU,CAAC,EAAE,CAAC,KAAI,CAAC,IAAI,EAAE,KAAI,CAAC,cAAc,EAAE,QAAQ,CAAC,CAAC;aAC9D,CAAC,CAAC;YACH,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;SAC3E;aAAM;YACL,MAAM,IAAI,KAAK,CAAC,0EAA0E,CAAC,CAAC;SAC7F;KACF;IAEM,qCAAW,GAAlB,UAAmB,OAAO;QAA1B,iBAYC;QAXC,IAAI,OAAO,CAAC,MAAM,CAAC,EAAE;YACnB,IAAI,IAAI,CAAC,iBAAiB,EAAE;gBAC1B,IAAI,CAAC,iBAAiB,CAAC,WAAW,EAAE,CAAC;aACtC;YACD,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,SAAS,CAAC,UAAC,OAAY;;gBACjF,KAAI,CAAC,OAAO,GAAG,EAAE,CAAC;;oBAClB,KAAqB,IAAA,YAAA,SAAA,OAAO,CAAA,gCAAA,qDAAE;wBAAzB,IAAM,MAAM,oBAAA;wBACf,KAAI,CAAC,OAAO,CAAC,MAAM,CAAC,MAAM,CAAC,GAAG,MAAM,CAAC,KAAK,IAAI,IAAI,CAAC;qBACpD;;;;;;;;;aACF,CAAC,CAAC;SACJ;KACF;IAEM,yCAAe,GAAtB;QAAA,iBAMC;QALC,IAAM,MAAM,GAAG,MAAM,CAAC,gBAAgB,CAAC,WAAW,EAAE,UAAC,KAAK;YACxD,IAAI,CAAE,KAAK,CAAC,MAAkB,CAAC,OAAO,CAAC,mBAAmB,CAAC,EAAE;gBAC3D,KAAI,CAAC,cAAc,GAAG,KAAK,CAAC;aAC7B;SACF,CAAC,CAAC;KACJ;;gBA5HyB,UAAU;gBAAqB,qBAAqB;gBAAe,eAAe;gBAAoB,iBAAiB;gBAA6B,wBAAwB;;IAZtM;QADC,KAAK,EAAE;iDACwB;IAGhC;QADC,KAAK,EAAE;oDACuC;IAY/C;QADC,YAAY,CAAC,WAAW,EAAE,CAAC,QAAQ,CAAC,CAAC;oDAKrC;IAGD;QADC,YAAY,CAAC,OAAO,EAAE,CAAC,QAAQ,CAAC,CAAC;gDAQjC;IAMD;QAJC,SAAS,CAAC,UAAU,EAAE;YACrB,IAAI,EAAE,gBAAgB;YACtB,MAAM,EAAE,IAAI;SACb,CAAC;6DACgC;IAtCvB,eAAe;QAL3B,SAAS,CAAC;YACT,QAAQ,EAAE,SAAS;YACnB,2zBAAuC;;SAExC,CAAC;OACW,eAAe,CA4I3B;IAAD,sBAAC;CA5ID;;;IC8FE,4BACY,EAAc,EACd,UAAiC,EACjC,UAAiC,EACjC,MAAyB,EACzB,SAAuB,EACvB,eAAyC,EAC3C,QAAmB,EACD,QAAa;QAP7B,OAAE,GAAF,EAAE,CAAY;QACd,eAAU,GAAV,UAAU,CAAuB;QACjC,eAAU,GAAV,UAAU,CAAuB;QACjC,WAAM,GAAN,MAAM,CAAmB;QACzB,cAAS,GAAT,SAAS,CAAc;QACvB,oBAAe,GAAf,eAAe,CAA0B;QAC3C,aAAQ,GAAR,QAAQ,CAAW;QACD,aAAQ,GAAR,QAAQ,CAAK;QAxDlC,SAAI,GAAW,SAAS,CAAC;QASzB,gBAAW,GAAW,EAAE,CAAC;QAGzB,iBAAY,GAAY,KAAK,CAAC;QAG9B,UAAK,GAAG,IAAI,YAAY,EAAQ,CAAC;QAGjC,SAAI,GAAG,IAAI,YAAY,EAAQ,CAAC;QAMhC,UAAK,GAAY,IAAI,CAAC;QAiBnB,cAAS,GAAY,KAAK,CAAC;QAE7B,iBAAY,GAAmB,EAAE,CAAC;;QAuXhC,YAAO,GAAG,IAAI,KAAK,EAA2B,CAAC;KAzWrD;2BA5DO,kBAAkB;IAoC7B,sBAAc,oDAAoB;aAAlC,UAAmC,UAAmC;YACpE,IAAI,CAAC,UAAU,GAAG,UAAU,CAAC,aAAa,CAAC;SAC5C;;;OAAA;IASD,sBAAY,2CAAW;aAAvB,UAAwB,OAAmB;YACzC,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;SACjC;;;OAAA;IAaO,qCAAQ,GAAhB;;;YACE,KAAsB,IAAA,KAAA,SAAA,IAAI,CAAC,YAAY,CAAA,gBAAA,4BAAE;gBAApC,IAAM,OAAO,WAAA;gBAChB,OAAO,EAAE,CAAC;aACX;;;;;;;;;KACF;IAEO,2CAAc,GAAtB;QACE,IAAM,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,YAAY,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;QAC3D,IAAM,cAAc,GAAG,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;QACnD,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,CAAC,cAAc,CAAC,GAAA,CAAC,CAAC;KAC9C;IAEM,qCAAQ,GAAf;QACE,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;KAC/B;IAEM,4CAAe,GAAtB;QAAA,iBA8KC;QA7KC,IAAI,IAAI,CAAC,GAAG,EAAE;YACZ,IAAI,CAAC,aAAa,EAAE,CAAC;SACtB;QAED,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,CACrC,IAAI,CAAC,UAAU,EACf,OAAO,EACP,UAAC,KAAiB;YAChB,OAAO,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;;YAEvB,KAAI,CAAC,aAAa,EAAE,CAAC;;YAErB,KAAI,CAAC,uBAAuB,EAAE,CAAC;SAChC,CACF,CAAC;QAEF,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,CACrC,IAAI,CAAC,UAAU,EACf,OAAO,EACP,UAAC,KAAoB;YACnB,OAAO,CAAC,KAAK,CAAC,YAAY,CAAC,CAAC;;YAE5B,KAAI,CAAC,aAAa,EAAE,CAAC;;YAErB,KAAI,CAAC,uBAAuB,EAAE,CAAC;SAChC,CACF,CAAC;QAEF,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,CACrC,IAAI,CAAC,UAAU,EACf,OAAO,EACP,UAAC,KAAiB;YAChB,OAAO,CAAC,KAAK,CAAC,GAAG,GAAG,KAAI,CAAC,IAAI,GAAG,SAAS,CAAC,CAAC;;YAE3C,KAAI,CAAC,gBAAgB,EAAE,CAAC;YACxB,KAAI,CAAC,SAAS,GAAG,IAAI,CAAC;YACtB,KAAI,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC;SACnB,CACF,CAAC;QACF,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,CACrC,IAAI,CAAC,UAAU,EACf,MAAM,EACN,UAAC,KAAiB;YAChB,OAAO,CAAC,KAAK,CAAC,GAAG,GAAG,KAAI,CAAC,IAAI,GAAG,QAAQ,CAAC,CAAC;YAC1C,KAAI,CAAC,SAAS,GAAG,KAAK,CAAC;YACvB,KAAI,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC;YACjB,KAAI,CAAC,aAAa,EAAE,CAAC;YAErB,IAAI,KAAI,CAAC,iBAAiB,EAAE;gBAC1B,UAAU,CAAC;oBACT,KAAI,CAAC,YAAY,GAAG,IAAI,CAAC;oBACzB,KAAI,CAAC,iBAAiB,CAAC,OAAO,EAAE,CAAC;iBAClC,EAAE,GAAG,CAAC,CAAC;;;aAGT;SACF,CACF,CAAC;QAEF,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,CACrC,IAAI,CAAC,UAAU,EACf,SAAS,EACT,UAAC,KAAoB;YACnB,OAAO,CAAC,KAAK,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC;YAChC,IAAM,WAAW,GAAG;gBAClB,KAAK,CAAC,cAAc,EAAE,CAAC;gBACvB,KAAK,CAAC,eAAe,EAAE,CAAC;aACzB,CAAC;YACF,IAAM,yBAAyB,GAAG;gBAChC,WAAW,EAAE,CAAC;gBACd,KAAI,CAAC,UAAU,EAAE,CAAC;gBAClB,KAAI,CAAC,cAAc,EAAE,CAAC;aACvB,CAAC;;;;;;;;;;;;;YAaF,IACE,KAAK,CAAC,GAAG,KAAK,WAAW;iBACxB,KAAK,CAAC,GAAG,KAAK,QAAQ,IAAI,KAAI,CAAC,cAAc,CAAC,EAC/C;gBACA,IAAM,IAAI,GAAG,KAAI,CAAC,cAAc,CAAC,uBAAuB,CAAC;gBACzD,OAAO,CAAC,KAAK,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC;gBAChC,IACE,IAAI,YAAY,WAAW;oBAC3B,CAAE,IAAoB,CAAC,iBAAiB,EACxC;;oBAEA,OAAO,CAAC,KAAK,CAAC,4CAA4C,CAAC,CAAC;oBAC5D,KAAI,CAAC,cAAc,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;oBACrC,KAAI,CAAC,cAAc,CAAC,cAAc,EAAE,CAAC;oBACrC,yBAAyB,EAAE,CAAC;iBAC7B;qBAAM,IACL,IAAI,CAAC,QAAQ,KAAK,OAAO;oBACzB,CAAC,IAAI,CAAC,aAAa,CAAC,iBAAiB,EACrC;;oBAEA,OAAO,CAAC,KAAK,CAAC,4CAA4C,CAAC,CAAC;oBAC5D,KAAI,CAAC,cAAc,CAAC,UAAU,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;oBACnD,KAAI,CAAC,cAAc,CAAC,cAAc,EAAE,CAAC;oBACrC,yBAAyB,EAAE,CAAC;iBAC7B;aACF;;;;YAID,IAAI,KAAK,CAAC,GAAG,KAAK,WAAW,IAAI,KAAI,CAAC,cAAc,EAAE;gBACpD,IAAM,IAAI,GAAG,KAAI,CAAC,cAAc,CAAC,uBAAuB,CAAC;gBACzD,IACE,KAAI,CAAC,cAAc,CAAC,SAAS,KAAK,IAAI;oBACtC,KAAI,CAAC,cAAc,CAAC,WAAW,KAAK,CAAC;oBACrC,IAAI,CAAC,eAAe,YAAY,WAAW;oBAC3C,CAAE,IAAI,CAAC,eAA+B,CAAC,iBAAiB,EACxD;oBACA,IAAI,CAAC,eAAe,CAAC,MAAM,EAAE,CAAC;oBAC9B,yBAAyB,EAAE,CAAC;iBAC7B;aACF;iBAAM,IAAI,KAAK,CAAC,GAAG,KAAK,QAAQ,IAAI,KAAI,CAAC,cAAc,EAAE;gBACxD,IAAM,IAAI,GAAG,KAAI,CAAC,cAAc,CAAC,uBAAuB,CAAC;gBACzD,IACE,KAAI,CAAC,cAAc,CAAC,SAAS,KAAK,IAAI;oBACtC,KAAI,CAAC,cAAc,CAAC,YAAY,CAAC,QAAQ,KAAK,OAAO;oBACrD,KAAI,CAAC,cAAc,CAAC,SAAS;wBAC1B,KAAI,CAAC,cAAc,CAAC,YAAqB,CAAC,MAAM;oBACnD,IAAI,CAAC,WAAW,YAAY,WAAW;oBACvC,CAAE,IAAI,CAAC,WAA2B,CAAC,iBAAiB,EACpD;oBACA,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC;oBAC1B,yBAAyB,EAAE,CAAC;iBAC7B;aACF;;;;YAID,IAAI,KAAI,CAAC,YAAY,EAAE;gBACrB,IAAI,KAAK,CAAC,GAAG,KAAK,IAAI,IAAI,KAAK,CAAC,GAAG,KAAK,SAAS,EAAE;oBACjD,WAAW,EAAE,CAAC;oBACd,KAAI,CAAC,gBAAgB,CAAC,aAAa,EAAE,CAAC;iBACvC;qBAAM,IAAI,KAAK,CAAC,GAAG,KAAK,MAAM,IAAI,KAAK,CAAC,GAAG,KAAK,WAAW,EAAE;oBAC5D,WAAW,EAAE,CAAC;oBACd,KAAI,CAAC,gBAAgB,CAAC,UAAU,EAAE,CAAC;iBACpC;qBAAM,IAAI,KAAK,CAAC,GAAG,KAAK,OAAO,EAAE;oBAChC,WAAW,EAAE,CAAC;oBACd,KAAI,CAAC,gBAAgB,CAAC,gBAAgB,EAAE,CAAC;iBAC1C;aACF;SACF,CACF,CAAC;QAEF,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,CACrC,IAAI,CAAC,UAAU,EACf,OAAO,EACP,UAAC,KAAiB;YAChB,OAAO,CAAC,KAAK,CAAC,eAAe,CAAC,CAAC;YAC/B,KAAI,CAAC,UAAU,EAAE,CAAC;YAClB,KAAI,CAAC,cAAc,EAAE,CAAC;SACvB,CACF,CAAC;;QAGF,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,UAAU,EAAE,YAAY,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;QAEzE,IAAI,IAAI,CAAC,YAAY,EAAE;YACrB,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,cAAM,OAAA,KAAI,CAAC,UAAU,CAAC,KAAK,EAAE,GAAA,CAAC,CAAC;SAC3D;KACF;IAEM,wCAAW,GAAlB,UAAmB,OAAsB;QACvC,IAAI,OAAO,CAAC,IAAI,EAAE;YAChB,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SAC/B;QACD,IAAI,OAAO,CAAC,GAAG,EAAE;YACf,IAAI,IAAI,CAAC,UAAU,EAAE;gBACnB,IAAI,CAAC,aAAa,EAAE,CAAC;aACtB;SACF;KACF;IAEM,wCAAW,GAAlB;QACE,IAAI,IAAI,CAAC,cAAc,EAAE;YACvB,IAAI,CAAC,cAAc,CAAC,WAAW,EAAE,CAAC;SACnC;QACD,IAAI,CAAC,QAAQ,EAAE,CAAC;KACjB;IAES,0CAAa,GAAvB;QACE,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,UAAU,EAAE,QAAQ,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;KAC7E;IAES,uCAAU,GAApB;QACE,IAAI,IAAI,CAAC,UAAU,CAAC,SAAS,KAAK,EAAE,EAAE;YACpC,IAAI,CAAC,QAAQ,CAAC,YAAY,CAAC,IAAI,CAAC,UAAU,EAAE,WAAW,EAAE,MAAM,CAAC,CAAC;YACjE,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;SACnB;aAAM,IAAI,IAAI,CAAC,UAAU,CAAC,SAAS,KAAK,MAAM,EAAE;YAC/C,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;SACnB;aAAM;YACL,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;SACpB;KACF;IAES,sCAAS,GAAnB,UAAoB,QAAgB;QAClC,IAAM,KAAK,GAAwB,MAAM,CAAC,gBAAgB,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;QAC5E,IAAI,MAAM,GAAG,QAAQ,CAAC,KAAK,CAAC,UAAU,EAAE,EAAE,CAAC,GAAG,QAAQ,CAAC;QAEvD,IAAI,KAAK,CAAC,SAAS,KAAK,YAAY,EAAE;YACpC,MAAM;gBACJ,QAAQ,CAAC,KAAK,CAAC,UAAU,EAAE,EAAE,CAAC;oBAC9B,QAAQ,CAAC,KAAK,CAAC,aAAa,EAAE,EAAE,CAAC;oBACjC,QAAQ,CAAC,KAAK,CAAC,cAAc,EAAE,EAAE,CAAC;oBAClC,QAAQ,CAAC,KAAK,CAAC,iBAAiB,EAAE,EAAE,CAAC,CAAC;SACzC;QACD,OAAO,MAAM,GAAG,IAAI,CAAC;KACtB;IAGS,0CAAa,GAAvB,UAAwB,IAAY;QAApC,iBAkCC;QAjCC,OAAO,CAAC,KAAK,CAAC,iBAAiB,GAAG,IAAI,EAAE,IAAI,CAAC,cAAc,CAAC,CAAC;QAC7D,IAAI,IAAI,CAAC,cAAc,EAAE;YACvB,IAAI,CAAC,cAAc,CAAC,WAAW,EAAE,CAAC;SACnC;QACD,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,SAAS,CAAC,UAAA,OAAO;;YAEnE,IAAM,aAAa,GAAY,KAAI,CAAC,QAAQ,CAAC,aAAa,CAAC;YAC3D,OAAO,CAAC,KAAK,CACX,GAAG,GAAG,IAAI,GAAG,gBAAgB,GAAG,OAAO,CAAC,IAAI,GAAG,GAAG,GAAG,OAAO,CAAC,KAAK,CACnE,CAAC;YAEF,KAAI,CAAC,gBAAgB,EAAE,CAAC;YACxB,IAAI,OAAO,CAAC,IAAI,KAAK,YAAY,IAAI,KAAI,CAAC,cAAc,EAAE;;;gBAGxD,KAAI,CAAC,cAAc,CAAC,cAAc,EAAE,CAAC;;gBAErC,KAAI,CAAC,cAAc,CAAC,UAAU,CAC5B,KAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,CAAC,wBAAwB,CAAC,OAAO,CAAC,KAAK,CAAC,CACpE,CAAC;;gBAEF,KAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;;gBAEpC,KAAI,CAAC,UAAU,EAAE,CAAC;gBAClB,KAAI,CAAC,cAAc,EAAE,CAAC;aACvB;iBAAM;gBACL,KAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,OAAO,CAAC,IAAI,EAAE,KAAK,EAAE,OAAO,CAAC,KAAK,CAAC,CAAC;aAC/D;YACD,KAAI,CAAC,aAAa,EAAE,CAAC;YACrB,IAAI,aAAa,YAAY,WAAW,EAAE;gBACxC,aAAa,CAAC,KAAK,EAAE,CAAC;aACvB;SACF,CAAC,CAAC;KACJ;IAIS,0CAAa,GAAvB;QACE,IAAI,IAAI,CAAC,yBAAyB,EAAE,EAAE;YACpC,IAAM,GAAG,GAAG,MAAM,CAAC,YAAY,EAAE,CAAC;YAClC,IAAI,GAAG,CAAC,UAAU,IAAI,GAAG,CAAC,UAAU,EAAE;gBACpC,IAAI,CAAC,cAAc,GAAG,GAAG,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;gBACxC,OAAO,CAAC,KAAK,CAAC,GAAG,GAAG,IAAI,CAAC,IAAI,GAAG,iBAAiB,EAAE,IAAI,CAAC,cAAc,CAAC,CAAC;gBACxE,IAAI,CAAC,WAAW,EAAE,CAAC;aACpB;SACF;KACF;;IAES,6CAAgB,GAA1B;QACE,IAAI,IAAI,CAAC,yBAAyB,EAAE,EAAE;YACpC,OAAO;SACR;QACD,OAAO,CAAC,KAAK,CAAC,GAAG,GAAG,IAAI,CAAC,IAAI,GAAG,oBAAoB,EAAE,IAAI,CAAC,cAAc,CAAC,CAAC;QAC3E,IAAI,IAAI,CAAC,cAAc,EAAE;YACvB,IAAM,GAAG,GAAG,MAAM,CAAC,YAAY,EAAE,CAAC;YAClC,GAAG,CAAC,eAAe,EAAE,CAAC;YACtB,GAAG,CAAC,QAAQ,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;SACnC;KACF;IAES,sDAAyB,GAAnC;QACE,IAAM,GAAG,GAAG,MAAM,CAAC,YAAY,EAAE,CAAC;QAClC,IAAM,IAAI,GACR,GAAG,CAAC,UAAU;YACd,GAAG,CAAC,UAAU;YACd,GAAG,CAAC,UAAU,CAAC,CAAC,CAAC;YACjB,GAAG,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,uBAAuB,CAAC;QAC5C,QACE,IAAI;aACH,IAAI,KAAK,IAAI,CAAC,UAAU;iBACtB,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,mBAAmB,CAAC;oBAC9C,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,mBAAmB,CAAC,KAAK,IAAI,CAAC,UAAU,CAAC,CAAC,EACzE;KACH;IAES,wCAAW,GAArB;QACE,IAAI,IAAI,GAAG,IAAI,CAAC,cAAc,CAAC,uBAAuB,CAAC;QACvD,IACE,CAAC,IAAI;YACL,EACE,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,mBAAmB,CAAC;gBAC/C,IAAI,KAAK,IAAI,CAAC,UAAU,CACzB,EACD;;;YAGA,OAAO;SACR;;QAED,IACE,IAAI,CAAC,cAAc,CAAC,SAAS,KAAK,CAAC;YACnC,IAAI,CAAC,cAAc,CAAC,cAAc,CAAC,SAAS;YAC5C,IAAI,CAAC,cAAc,CAAC,WAAW;gBAC7B,IAAI,CAAC,cAAc,CAAC,cAAc,CAAC,SAAS,CAAC,MAAM,EACrD;YACA,IAAI,GAAG,IAAI,CAAC,cAAc,CAAC,cAAc,CAAC,WAAW,CAAC;SACvD;aAAM,IACL,IAAI,CAAC,cAAc,CAAC,SAAS,KAAK,CAAC;YACnC,IAAI,CAAC,cAAc,CAAC,WAAW,KAAK,CAAC,EACrC;YACA,IAAI,GAAG,IAAI,CAAC,cAAc,CAAC,cAAc,CAAC,aAAa,CAAC;SACzD;aAAM,IACL,IAAI,CAAC,cAAc,CAAC,uBAAuB,KAAK,IAAI,CAAC,UAAU;YAC/D,IAAI,CAAC,cAAc,CAAC,cAAc,KAAK,IAAI,CAAC,UAAU;YACtD,IAAI,CAAC,cAAc,CAAC,YAAY,KAAK,IAAI,CAAC,UAAU,EACpD;YACA,IAAI,GAAG,IAAI,CAAC,cAAc,CAAC,uBAAuB,CAAC,UAAU,CAC3D,IAAI,CAAC,cAAc,CAAC,WAAW,CAChC,CAAC;SACH;QACD,IAAI,IAAI,IAAI,IAAI,KAAK,IAAI,CAAC,UAAU,EAAE;YACpC,IAAM,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,eAAe,CAAC,IAAI,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC;YACrE,OAAO,CAAC,KAAK,CAAC,yBAAyB,EAAE,KAAK,CAAC,CAAC;YAChD,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;SACjD;KACF;IAKM,uCAAU,GAAjB,UAAkB,KAAa;QAC7B,IAAI,KAAK,EAAE;YACT,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,uBAAuB,CACnD,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CACpD,CAAC;YACF,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;SACpB;aAAM;YACL,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,uBAAuB,CAAC,MAAM,CAAC,CAAC;YAC9D,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;SACnB;QACD,IAAI,CAAC,cAAc,GAAG,SAAS,CAAC;KACjC;IAEM,6CAAgB,GAAvB,UAAwB,EAA2B;QACjD,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;KACvB;IAEM,8CAAiB,GAAxB,UAAyB,EAAc,KAAI;IAEjC,oDAAuB,GAAjC;QACE,IAAM,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,cAAc,CAAC,WAAW,GAAG,EAAE,EAAE,CAAC,CAAC,CAAC;QACnE,IAAM,MAAM,GAAG,IAAI,CAAC,cAAc,CAAC,WAAW,GAAG,QAAQ,CAAC;QAC1D,IAAM,OAAO,GAAG,IAAI,CAAC,cAAc,CAAC,cAAc,CAAC,WAAW,CAAC,MAAM,CACnE,QAAQ,EACR,MAAM,CACP,CAAC;QAEF,IAAM,YAAY,GAAG,IAAI,CAAC,UAAU,CAAC,eAAe,CAAC,OAAO,CAAC,CAAC;QAC9D,IAAI,YAAY,EAAE;YAChB,IACE,CAAC,IAAI,CAAC,YAAY;gBAClB,IAAI,CAAC,YAAY,CAAC,QAAQ,KAAK,YAAY,CAAC,QAAQ,EACpD;gBACA,IAAI,CAAC,YAAY,GAAG,YAAY,CAAC;gBACjC,IAAI,CAAC,YAAY,CACf,YAAY,EACZ,IAAI,CAAC,cAAc,CAAC,qBAAqB,EAAE,CAC5C,CAAC;aACH;iBAAM;gBACL,IAAI,CAAC,YAAY,GAAG,YAAY,CAAC;gBACjC,IAAI,CAAC,cAAc,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC;aAC3C;SACF;aAAM,IAAI,IAAI,CAAC,iBAAiB,EAAE;YACjC,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;YACzB,IAAI,CAAC,iBAAiB,CAAC,OAAO,EAAE,CAAC;SAClC;KACF;IAES,yCAAY,GAAtB,UAAuB,eAAe,EAAE,QAAQ;QAAhD,iBA+BC;;QA7BC,IAAI,IAAI,CAAC,iBAAiB,EAAE;YAC1B,IAAI,CAAC,iBAAiB,CAAC,OAAO,EAAE,CAAC;SAClC;QACD,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,uBAAuB,CAC1D,eAAe,CAAC,QAAQ,CACzB,CAAC;QACF,IAAM,SAAS,GAAQ,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;QAC5E,IAAI,SAAS,CAAC,QAAQ,CAAC,WAAW,EAAE;YAClC,SAAS,CAAC,QAAQ,CAAC,KAAK,GAAG,eAAe,CAAC,OAAO,CAAC;YACnD,SAAS,CAAC,QAAQ,CAAC,WAAW,CAAC,SAAS,CAAC,UAAA,KAAK;gBAC5C,KAAI,CAAC,UAAU,CAAC,KAAK,EAAE,CAAC;gBACxB,IAAM,GAAG,GAAG,KAAI,CAAC,cAAc,CAAC,SAAS,CAAC;gBAC1C,KAAI,CAAC,cAAc,CAAC,QAAQ,CAC1B,KAAI,CAAC,cAAc,CAAC,YAAY,EAChC,GAAG,GAAG,eAAe,CAAC,OAAO,CAAC,MAAM,CACrC,CAAC;gBACF,KAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,KAAI,CAAC,IAAI,EAAE,KAAI,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;;gBAE9D,KAAI,CAAC,YAAY,GAAG,IAAI,CAAC;gBACzB,KAAI,CAAC,iBAAiB,CAAC,OAAO,EAAE,CAAC;aAClC,CAAC,CAAC;YACH,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;YAC1E,IAAI,CAAC,gBAAgB,GAAG,SAAS,CAAC,QAAQ,CAAC;YAC3C,IAAI,CAAC,sBAAsB,EAAE,CAAC;SAC/B;aAAM;YACL,MAAM,IAAI,KAAK,CACb,0EAA0E,CAC3E,CAAC;SACH;KACF;IAES,2CAAc,GAAxB,UAAyB,KAAK;QAC5B,IAAI,CAAC,gBAAgB,CAAC,KAAK,GAAG,KAAK,CAAC;QACpC,IAAI,CAAC,sBAAsB,EAAE,CAAC;KAC/B;IAES,mDAAsB,GAAhC;QACE,IAAI,IAAI,CAAC,YAAY,CAAC,OAAO,KAAK,YAAY,EAAE;;YAE9C,IAAM,cAAc,GAAG,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,YAAY,CAAC,qBAAqB,EAAE,CAAC;YAClF,IAAM,KAAK,GAAG,IAAI,CAAC,cAAc,CAAC,UAAU,EAAE,CAAC;YAC/C,IAAM,GAAG,GAAG,KAAK,CAAC,SAAS,CAAC;YAC5B,KAAK,CAAC,QAAQ,CACZ,KAAK,CAAC,YAAY,EAClB,GAAG,GAAG,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,MAAM,CACvC,CAAC;YACF,IAAM,WAAW,GAAG,KAAK,CAAC,qBAAqB,EAAE,CAAC;YAClD,IAAI,CAAC,kBAAkB;gBACrB,WAAW,CAAC,GAAG,GAAG,WAAW,CAAC,MAAM,GAAG,cAAc,CAAC,GAAG,GAAG,IAAI,CAAC;YACnE,IAAI,CAAC,mBAAmB,GAAG,WAAW,CAAC,IAAI,GAAG,cAAc,CAAC,IAAI,GAAG,IAAI,CAAC;SAC1E;KACF;;;gBAxde,UAAU;gBACF,qBAAqB;gBACrB,qBAAqB;gBACzB,iBAAiB;gBACd,YAAY;gBACN,wBAAwB;gBACjC,SAAS;gDAC1B,MAAM,SAAC,QAAQ;;IAxDlB;QADC,KAAK,EAAE;oDACwB;IAGhC;QADC,KAAK,EAAE;mDACW;IAGnB;QADC,KAAK,EAAE;2DACmB;IAG3B;QADC,KAAK,EAAE;2DACwB;IAGhC;QADC,KAAK,EAAE;4DAC6B;IAGrC;QADC,MAAM,EAAE;qDAC+B;IAGxC;QADC,MAAM,EAAE;oDAC8B;IAYvC;QAJC,SAAS,CAAC,UAAU,EAAE;YACrB,IAAI,EAAE,gBAAgB;YACtB,MAAM,EAAE,IAAI;SACb,CAAC;gEACiC;IAGnC;QADC,SAAS,CAAC,YAAY,EAAE,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC;kEAGzC;IAtCU,kBAAkB;QA7D9B,SAAS,CAAC;YACT,QAAQ,EAAE,YAAY;YACtB,QAAQ,EAAE,4hBAkBT;YAqCD,SAAS,EAAE;gBACT,EAAE,OAAO,EAAE,iBAAiB,EAAE,WAAW,EAAE,oBAAkB,EAAE,KAAK,EAAE,IAAI,EAAE;aAC7E;qBArCC,q3BAiCC;SAKJ,CAAC;QA4DG,WAAA,MAAM,CAAC,QAAQ,CAAC,CAAA;OA3DR,kBAAkB,CA6gB9B;IAAD,yBAAC;CA7gBD;;ACjFA,IAAI,eAAe,GAAG,CAAC,CAAC;;IAqDtB,gCAAY,EAAc,EAAE,UAAiC,EAAE,MAAyB,EAAE,IAAqB,EAAE,eAAyC;QAlCnJ,YAAO,GAAkB,cAAc,CAAC;;QAGrC,YAAO,GAAG,IAAI,KAAK,EAA2B,CAAC;QAC/C,iBAAY,GAAY,KAAK,CAAC;QA+BtC,IAAI,CAAC,IAAI,GAAG,YAAY,IAAI,eAAe,EAAE,CAAC,CAAC;KAChD;+BA7CU,sBAAsB;IAqB1B,qCAAI,GAAX,UAAa,KAAU;QACrB,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE;YACtB,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;SACxB;KACF;IAGM,0CAAS,GAAhB,UAAkB,KAAU;QAC1B,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;KAC1B;IAGM,wCAAO,GAAd,UAAgB,KAAU;QACxB,IAAI,CAAC,YAAY,GAAG,KAAK,CAAC;KAC3B;IAGM,sCAAK,GAAZ,UAAc,KAAU;QACtB,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;QACtB,OAAO,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAA;KAChC;IAMM,2CAAU,GAAjB,UAAkB,KAAa;QAC7B,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;KAC1B;IAEM,iDAAgB,GAAvB,UAAwB,EAA2B;QACjD,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;KACvB;IAEM,kDAAiB,GAAxB,UAAyB,EAAc,KAAI;;IAGpC,yCAAQ,GAAf,UAAgB,KAAK;QACnB,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;QACzB,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,CAAC,KAAK,CAAC,GAAA,CAAC,CAAC;KACrC;;;gBAlBe,UAAU;gBAAc,qBAAqB;gBAAU,iBAAiB;gBAAQ,eAAe;gBAAmB,wBAAwB;;IAxC1J;QADC,KAAK,EAAE;uDACI;IAGZ;QADC,KAAK,EAAE;+DACY;IAGpB;QADC,KAAK,EAAE;2DACuC;IAY/C;QADC,YAAY,CAAC,UAAU,EAAE,CAAC,QAAQ,CAAC,CAAC;sDAKpC;IAGD;QADC,YAAY,CAAC,WAAW,EAAE,CAAC,QAAQ,CAAC,CAAC;2DAGrC;IAGD;QADC,YAAY,CAAC,SAAS,EAAE,CAAC,QAAQ,CAAC,CAAC;yDAGnC;IAGD;QADC,YAAY,CAAC,SAAS,EAAE,CAAC,QAAQ,CAAC,CAAC;uDAInC;IAzCU,sBAAsB;QARlC,SAAS,CAAC;YACT,QAAQ,EAAE,gBAAgB;YAC1B,+TAA8C;YAE9C,SAAS,EAAE;gBACT,EAAC,OAAO,EAAE,iBAAiB,EAAE,WAAW,EAAE,wBAAsB,EAAE,KAAK,EAAE,IAAI,EAAC;aAC/E;;SACF,CAAC;OACW,sBAAsB,CA8DlC;IAAD,6BAAC;CA9DD;;;ICX6C,2CAAe;IAA5D;;KAA+D;;IAAlD,uBAAuB;QAHnC,UAAU,CAAC;YACV,UAAU,EAAE,MAAM;SACnB,CAAC;OACW,uBAAuB,CAA2B;kCAP/D;CAO+D,CAAlB,eAAe;;ACM5D,IAAIA,iBAAe,GAAG,CAAC,CAAC;;IAsHtB,+BAAY,UAAiC,EAAE,MAAyB,EAAE,IAAqB,EAAE,EAAc,EAA6B,SAAoB;QAApB,cAAS,GAAT,SAAS,CAAW;QArGzJ,YAAO,GAAkB,cAAc,CAAC;QAyB/C,OAAE,GAAG,KAAG,IAAI,CAAC,IAAM,CAAC;QA2Bb,iBAAY,GAAG,KAAK,CAAC;QACrB,cAAS,GAAG,KAAK,CAAC;QAkBf,cAAS,GAAG,KAAK,CAAC;QAUlB,cAAS,GAAG,KAAK,CAAC;QAErB,eAAU,GAAG,KAAK,CAAC;QAEnB,gBAAW,GAAG,eAAe,CAAC;QAGrC,gBAAW,GAAG,EAAE,CAAC;QAQV,iBAAY,GAAG,IAAI,OAAO,EAAQ,CAAC;QACnC,YAAO,GAAG,KAAK,CAAC;QAEb,YAAO,GAAG,IAAI,KAAK,EAA2B,CAAC;QAGvD,IAAI,CAAC,IAAI,GAAG,WAAW,IAAIA,iBAAe,EAAE,CAAC,CAAC;;;QAG9C,IAAI,IAAI,CAAC,SAAS,IAAI,IAAI,EAAE;YAC1B,IAAI,CAAC,SAAS,CAAC,aAAa,GAAG,IAAI,CAAC;SACrC;KACF;8BAlHU,qBAAqB;IAShC,sBAAW,wCAAK;aAAhB;YACE,OAAO,IAAI,CAAC,WAAW,CAAC;SACzB;aACD,UAAiB,KAAa;YAC5B,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC;YACzB,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;YACzB,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,CAAC,KAAK,CAAC,GAAA,CAAC,CAAC;SACrC;;;OALA;IASD,sBAAI,8CAAW;aAAf;YACE,OAAO,IAAI,CAAC,YAAY,CAAC;SAC1B;aACD,UAAgB,WAAW;YACzB,IAAI,CAAC,YAAY,GAAG,WAAW,CAAC;YAChC,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC;SAC1B;;;OAJA;IAYM,oCAAI,GAAX;QACE,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;QACrB,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC;QACzB,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE;YACtB,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;SACxB;KACF;IAGM,qCAAK,GAAZ;QACE,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;QACpB,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;QACtB,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC;KAC1B;IAGM,yCAAS,GAAhB,UAAkB,KAAU;QAC1B,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;KAC1B;IAGM,uCAAO,GAAd,UAAgB,KAAU;QACxB,IAAI,CAAC,YAAY,GAAG,KAAK,CAAC;KAC3B;IAID,sBAAI,wCAAK;aAAT;YACE,OAAO,CAAC,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,WAAW,KAAK,EAAE,CAAC;SACrD;;;OAAA;IAED,sBAAI,mDAAgB;aAApB;YACE,OAAO,IAAI,CAAC,OAAO,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC;SACpC;;;OAAA;IAGD,sBAAI,2CAAQ;aAAZ;YACE,OAAO,IAAI,CAAC,SAAS,CAAC;SACvB;aACD,UAAa,GAAG;YACd,IAAI,CAAC,SAAS,GAAG,qBAAqB,CAAC,GAAG,CAAC,CAAC;YAC5C,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC;SAC1B;;;OAJA;IAQD,sBAAI,2CAAQ;aAAZ;YACE,OAAO,IAAI,CAAC,SAAS,CAAC;SACvB;aACD,UAAa,GAAG;YACd,IAAI,CAAC,SAAS,GAAG,qBAAqB,CAAC,GAAG,CAAC,CAAC;YAC5C,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC;SAC1B;;;OAJA;IAcM,iDAAiB,GAAxB,UAAyB,GAAa;QACpC,IAAI,CAAC,WAAW,GAAG,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;KAClC;IAEM,gDAAgB,GAAvB,UAAwB,KAAiB,KAAI;IAgBtC,wCAAQ,GAAf,UAAgB,KAAK;QACnB,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;QACzB,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,CAAC,KAAK,CAAC,GAAA,CAAC,CAAC;QACpC,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC;KAC1B;IAEM,2CAAW,GAAlB;QACE,IAAI,CAAC,YAAY,CAAC,QAAQ,EAAE,CAAC;KAC9B;IAEM,0CAAU,GAAjB,UAAkB,KAAa;QAC7B,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;QACzB,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC;KAC1B;IAEM,gDAAgB,GAAvB,UAAwB,EAA2B;QACjD,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;KACvB;IAEM,iDAAiB,GAAxB,UAAyB,EAAc,KAAI;;;gBA5BnB,qBAAqB;gBAAU,iBAAiB;gBAAQ,eAAe;gBAAM,UAAU;gBAAwC,SAAS,uBAA9C,QAAQ,YAAI,IAAI;;IAxGlI;QADC,KAAK,EAAE;sDACI;IAGZ;QADC,KAAK,EAAE;0DACuC;IAG/C;QADC,KAAK,EAAE;sDAGP;IASD;QADC,KAAK,EAAE;4DAGP;IASD;QADC,WAAW,EAAE;qDACM;IAGpB;QADC,YAAY,CAAC,UAAU,CAAC;qDAOxB;IAGD;QADC,YAAY,CAAC,SAAS,CAAC;sDAKvB;IAGD;QADC,YAAY,CAAC,WAAW,EAAE,CAAC,QAAQ,CAAC,CAAC;0DAGrC;IAGD;QADC,YAAY,CAAC,SAAS,EAAE,CAAC,QAAQ,CAAC,CAAC;wDAGnC;IAaD;QADC,KAAK,EAAE;yDAGP;IAQD;QADC,KAAK,EAAE;yDAGP;IAYD;QADC,WAAW,CAAC,uBAAuB,CAAC;8DACpB;IA9FN,qBAAqB;QATjC,SAAS,CAAC;YACT,QAAQ,EAAE,eAAe;YACzB,gRAA6C;YAE7C,SAAS,EAAE;gBACT,EAAE,OAAO,EAAE,mBAAmB,EAAE,WAAW,EAAE,uBAAqB,EAAE;gBACpE,EAAE,OAAO,EAAE,eAAe,EAAE,QAAQ,EAAE,uBAAuB,EAAE;aAChE;;SACF,CAAC;QA4GkH,WAAA,QAAQ,EAAE,CAAA,EAAE,WAAA,IAAI,EAAE,CAAA;OA3GzH,qBAAqB,CAwIjC;IAAD,4BAAC;CAxID;;;ICjBqD,mDAAe;IAApE;QAAA,qEAsBC;QApBW,iBAAW,GAAG;YACtB,MAAM,EAAG,4BAA4B;YACrC,QAAQ,EAAG,8BAA8B;YACzC,WAAW,EAAG,iCAAiC;YAC/C,QAAQ,EAAG,qCAAqC;YAChD,WAAW,EAAI,iCAAiC;YAChD,aAAa,EAAG,mCAAmC;YACnD,QAAQ,EAAG,8BAA8B;YACzC,SAAS,EAAG,+BAA+B;YAC3C,SAAS,EAAG,+BAA+B;YAC3C,WAAW,EAAG,+BAA+B;YAC7C,QAAQ,EAAG,oCAAoC;YAC/C,SAAS,EAAG,qCAAqC;YACjD,MAAM,EAAG,kCAAkC;YAC3C,OAAO,EAAG,mCAAmC;YAC7C,MAAM,EAAG,4BAA4B;YACrC,MAAM,EAAG,8BAA8B;YACvC,OAAO,EAAG,8BAA8B;YACxC,MAAM,EAAG,4BAA4B;SACtC,CAAC;;KACH;;IAtBY,+BAA+B;QAH3C,UAAU,CAAC;YACV,UAAU,EAAE,MAAM;SACnB,CAAC;OACW,+BAA+B,CAsB3C;0CA7BD;CA6BC,CAtBoD,eAAe;;;ICmCpE;KAA0B;IAAb,UAAU;QAftB,QAAQ,CAAC;YACR,YAAY,EAAE;gBACZ,kBAAkB;gBAClB,eAAe;gBACf,sBAAsB;gBACtB,yBAAyB;aAC1B;YACD,OAAO,EAAE,CAAC,YAAY,EAAE,WAAW,EAAE,kBAAkB,EAAE,iBAAiB,CAAC;YAC3E,OAAO,EAAE;gBACP,eAAe;gBACf,kBAAkB;gBAClB,sBAAsB;gBACtB,yBAAyB;aAC1B;SACF,CAAC;OACW,UAAU,CAAG;IAAD,iBAAC;CAA1B,IAA0B;;IAO1B;KAAkC;IAArB,kBAAkB;QAL9B,QAAQ,CAAC;YACR,YAAY,EAAE,CAAC,qBAAqB,CAAC;YACrC,OAAO,EAAE,CAAC,YAAY,EAAE,WAAW,EAAE,kBAAkB,EAAE,UAAU,CAAC;YACpE,OAAO,EAAE,CAAC,qBAAqB,CAAC;SACjC,CAAC;OACW,kBAAkB,CAAG;IAAD,yBAAC;CAAlC;;ACjDA;;;;;;"}